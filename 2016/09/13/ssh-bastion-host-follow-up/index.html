<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>A Follow Up on SSH Bastion Hosts - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="A Follow Up on SSH Bastion Hosts - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="A Follow Up on SSH Bastion Hosts - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2016/09/13/ssh-bastion-host-follow-up/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">A Follow Up on SSH Bastion Hosts</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 139 May 131313 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/information">Information</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;381 words (estimated 2 minutes to read)</span>
  <p>This post is a follow-up on my earlier post on <a href="/2015/11/21/using-ssh-bastion-host/">using an SSH bastion host</a>. Since that article was published, I&rsquo;ve gotten some additional information that I wanted to be sure to share with my readers. It&rsquo;s possible that this additional information may not affect you, but I&rsquo;ll allow you to make that determination based on your use case and your specific environment.</p>
<h2 id="agent-forwarding">Agent Forwarding</h2>
<p>You may recall that my original article said that you needed to enable agent forwarding, either via the <code>-A</code> command-line switch or via a <code>ForwardAgent</code> line in your SSH configuration file. <strong>This is unnecessary.</strong> (Thank you to several readers who contacted me about this issue.) I tested this several times using AWS instances, and was able to transparently connect to private instances (instances without a public IP address) via a bastion host without enabling agent forwarding. This is odd because almost <em>every</em> other tutorial I&rsquo;ve seen or read instructs readers to enable agent forwarding. I&rsquo;ve not yet determined why this is the case, but I&rsquo;m going to do some additional testing and I&rsquo;ll keep readers posted as I learn more.</p>
<p>Note that I&rsquo;ve updated the original article accordingly.</p>
<h2 id="the--w-parameter-vs-netcat">The &ldquo;-W&rdquo; Parameter vs. Netcat</h2>
<p>The original <code>ProxyCommand</code> I shared with you was this:</p>
<pre><code>ProxyCommand ssh bastion -W %h:%p
</code></pre>
<p>In this command, the <code>-W</code> command is a command-line option for SSH that enables &ldquo;netcat mode.&rdquo; This option was added in OpenSSH 5.4, released in March 2010 (see <a href="http://www.openssh.com/txt/release-5.4">the OpenSSH 5.4 release notes</a>). If you think you may need to work with earlier versions of SSH, then this could be a problem.</p>
<p>The solution to the problem is to use &ldquo;real&rdquo; netcat on the <code>ProxyCommand</code>, like this:</p>
<pre><code>ProxyCommand ssh bastion nc %h %p 2&gt; /dev/null
</code></pre>
<p>As with the original command, the <code>%h</code> and <code>%p</code> parameters expand to host and port, respectively. The <code>2&gt; /dev/null</code> at the end of the command suppresses an error message from Netcat when disconnecting from the remote system. This command will work with both newer and older versions of OpenSSH, and therefore may prove to be a better option than the use of the <code>-W</code> parameter. (To be fair, though, most recent distributions of Linux will come with a version of OpenSSH that is new enough to support this parameter.)</p>
<p>I hope this information helps!</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/linux">Linux</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/ssh">SSH</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/cli">CLI</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/networking">Networking</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/security">Security</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2016/09/09/technology-short-take-71/">Technology Short Take #71</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2016/09/15/using-vagrant-with-aws/">Using Vagrant with AWS</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2016%2f09%2f13%2fssh-bastion-host-follow-up%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2016%2f09%2f13%2fssh-bastion-host-follow-up%2f&text=A%20Follow%20Up%20on%20SSH%20Bastion%20Hosts" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2016%2f09%2f13%2fssh-bastion-host-follow-up%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2015/11/21/using-ssh-bastion-host/">Using an SSH Bastion Host</a> <span class="post-date-list">219 May 212121</span></li><li><a href="/2016/08/12/technology-short-take-70/">Technology Short Take #70</a> <span class="post-date-list">129 May 121212</span></li><li><a href="/2016/01/15/technology-short-take-59/">Technology Short Take #59</a> <span class="post-date-list">159 May 151515</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
