<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Working Around Docker Desktop&#39;s Outdated Kubernetes Version - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="Working Around Docker Desktop&#39;s Outdated Kubernetes Version - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="Working Around Docker Desktop&#39;s Outdated Kubernetes Version - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2020/07/08/working-around-docker-desktops-outdated-kubernetes-version/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">Working Around Docker Desktop&#39;s Outdated Kubernetes Version</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 89 May 8088 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/tutorial">Tutorial</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;648 words (estimated 4 minutes to read)</span>
  <p>As of the time that I published this blog post in early July 2020, <a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a> for macOS was at version 2.2.0.4 (for the &ldquo;stable&rdquo; channel). That version includes a relatively recent version of the Docker engine (19.03.8, compared to 19.03.12 on my <a href="https://getfedora.org/">Fedora</a> 31 box), but a quite outdated version of <a href="https://kubernetes.io/">Kubernetes</a> (1.15.5, which isn&rsquo;t supported by upstream). Now, this may not be a problem for users who <em>only</em> use Kubernetes via Docker Desktop. For me, however, the old version of Kubernetes&mdash;specifically the old version of <code>kubectl</code>&mdash;causes problems. Here&rsquo;s how I worked around the old version that Docker Desktop supplies. (Also, see the update at the bottom for some additional details that emerged after this post was originally published.)</p>
<p>First, you&rsquo;ll note that Docker Desktop automatically symlinks its version of <code>kubectl</code> into your system path at <code>/usr/local/bin</code>. You can verify the version of Docker Desktop&rsquo;s <code>kubectl</code> by running this command:</p>
<pre><code>/usr/local/bin/kubectl version --client=true
</code></pre>
<p>On my macOS 10.14.6-based system, this returned a version of 1.15.5. <a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.15.5">According to GitHub</a>, v1.15.5 was released in October of 2019. Per <a href="https://kubernetes.io/docs/setup/release/version-skew-policy/">the Kubernetes version skew policy</a>, this version of <code>kubectl</code> would work with with 1.14, 1.15, and 1.16. What if I need to work with a 1.17 or 1.18 cluster? Simple&mdash;it just won&rsquo;t work. In my case, I regularly need to work with newer Kubernetes versions, hence the issue with this old bundled version of <code>kubectl</code>.</p>
<p>Unfortunately, you can&rsquo;t just delete or rename the symlink that Docker Desktop creates; it will simply re-create the symlink the next time it launches.</p>
<p>So what&rsquo;s the fix? Because <code>/usr/local/bin</code> is typically pretty early in the system search path (use <code>echo $PATH</code> to see), you&rsquo;ll need to create a symlink <em>earlier in the search path.</em> Here&rsquo;s one way to do that:</p>
<ol>
<li>Create a <code>$HOME/bin</code> or <code>$HOME/.local/bin</code> directory (I prefer the latter, since it mimics my Linux system).</li>
<li>Modify your shell startup files to include this new directory in your search path.</li>
<li>Create a symlink to a newer version of <code>kubectl</code> in that directory.</li>
</ol>
<p>The steps above should be pretty straightforward, but I&rsquo;ll expand just a bit on item #2. I&rsquo;m using <code>bash</code> as my shell on macOS (again, for similarity across macOS and Linux; I&rsquo;ve installed the latest <code>bash</code> version via <code>homebrew</code>), and so I added this snippet to my <code>~/.bash_profile</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Set PATH so it includes user&#39;s personal bin directories</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if those directories exist</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -d <span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/.local/bin&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    PATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/.local/bin:</span>$PATH<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -d <span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/bin&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    PATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/bin:</span>$PATH<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><p>With this in <code>~/.bash_profile</code>, <em>if</em> a <code>$HOME/bin</code> or <code>$HOME/.local/bin</code> directory exists, it gets added to the <em>start</em> of the search path&mdash;thus placing it before <code>/usr/local/bin</code>, and thus making sure that any executables or symlinks placed there will be found <em>before</em> those in <code>/usr/local/bin</code>. Therefore, when I place a symlink to a newer version of <code>kubectl</code> in one of these directories, it will get found <em>before</em> Docker Desktop&rsquo;s outdated version. Problem solved! (You can, of course, still access the older Docker Desktop version by using the full path.)</p>
<p>Folks who are familiar with UNIX/Linux are probably already very familiar with this sort of approach. However, I suspect there are a fair number of my readers who may be using macOS-based systems but aren&rsquo;t well-versed in the intricacies of manipulating the <code>$PATH</code> environment variable. Hopefully, this article helps those folks. Feel free to contact me on Twitter if you have any questions or feedback on what I&rsquo;ve shared here.</p>
<p><strong>UPDATE 2020-07-09:</strong> Several folks contacted me on Twitter (thank you!) to point out that a slightly newer version of Docker Desktop may be available in the stable channel, although I have not been able to update my installation thus far. The new version, version 2.3.0.3, comes with Kubernetes 1.16.5, and therefore may not be as problematic for folks as the older version I have on my system. Regardless, the workaround remains valid. Thanks to the readers who responded!</p>

  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/docker">Docker</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/kubernetes">Kubernetes</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/macos">macOS</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/cli">CLI</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2020/07/01/creating-aws-security-group-using-pulumi-and-go/">Creating an AWS Security Group using Pulumi and Go</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2020/07/17/technology-short-take-129/">Technology Short Take 129</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2020%2f07%2f08%2fworking-around-docker-desktops-outdated-kubernetes-version%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2020%2f07%2f08%2fworking-around-docker-desktops-outdated-kubernetes-version%2f&text=Working%20Around%20Docker%20Desktop%27s%20Outdated%20Kubernetes%20Version" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2020%2f07%2f08%2fworking-around-docker-desktops-outdated-kubernetes-version%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2020/06/19/technology-short-take-128/">Technology Short Take 128</a> <span class="post-date-list">199 May 191919</span></li><li><a href="/2018/02/24/technology-short-take-95/">Technology Short Take 95</a> <span class="post-date-list">249 May 242424</span></li><li><a href="/2020/03/19/using-kind-with-docker-machine-on-macos/">Using KinD with Docker Machine on macOS</a> <span class="post-date-list">199 May 191919</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
