<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>CPU Spike with DRS and VMotion - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="CPU Spike with DRS and VMotion - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="CPU Spike with DRS and VMotion - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2008/01/20/cpu-spike-with-drs-and-vmotion/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">CPU Spike with DRS and VMotion</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 209 May 202020 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/explanation">Explanation</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;224 words (estimated 2 minutes to read)</span>
  <p>An issue has been discovered that can cause a CPU spike when VMotion is used in a DRS-enabled cluster with ESX Server 3.5 and VirtualCenter 2.5. It is my understanding that this can occur with both DRS-initiated VMotion operations as well as manually-initiated VMotion operations.</p>
<p>Fortunately, there&rsquo;s a workaround for this issue which involves editing the <code>vpxd.cfg</code> on the VirtualCenter server. Full details on the change that needs to be made, as well as on the log entries that you should see on ESX Server afterward, are found <a href="http://www.vmwarewolf.com/vmotion-in-35-drs-enabled-cluster-causes-guest-cpu-to-rise-dramatically/">in this article</a>.</p>
<p><strong>UPDATE:</strong> It appears that VMwarewolf has had to <a href="http://www.vmwarewolf.com/crossing-the-line/">pull the original article</a> that described this problem and the workaround. Fortunately, Google has a long memory, and here&rsquo;s the workaround for this problem.</p>
<p>Immediately after the <code>&lt;vpxd&gt;</code> line in <code>vpxd.cfg</code>, add the following lines:</p>
<pre><code>&lt;cluster&gt;  
&lt;VMOverheadGrowthLimit&gt;5&lt;/VMOverheadGrowthLimit&gt;  
&lt;/cluster&gt;
</code></pre>
<p>I&rsquo;m guessing that this information may not be information that VMware wants easily disseminated to the world, or that the workaround has not been fully and completely tested. So, use this information at your own risk.</p>
<p>In the meantime, <a href="http://www.google.com/search?hl=en&amp;q=vmwarewolf+vpxd+CPU+spike&amp;btnG=Google+Search">this Google search</a> will return the now-unavailable page; use the <a href="http://64.233.169.104/search?q=cache:l8o2KgswQPkJ:www.vmwarewolf.com/+vmwarewolf+vpxd+CPU+spike&amp;hl=en&amp;ct=clnk&amp;cd=1&amp;gl=us">Cached</a> link to see the workaround and the details from the log file that will help troubleshoot the problem.</p>
<p><strong>UPDATE 2:</strong> VMware has now published <a href="http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1003638">this KB article</a> about the issue, along with the workaround for the problem.</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/esx">ESX</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/virtualization">Virtualization</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/vmotion">VMotion</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/vmware">VMware</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2008/01/20/leopard-upgrade/">Leopard Upgrade</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2008/01/20/recent-virtualization-links/">Recent Virtualization Links</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2008%2f01%2f20%2fcpu-spike-with-drs-and-vmotion%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2008%2f01%2f20%2fcpu-spike-with-drs-and-vmotion%2f&text=CPU%20Spike%20with%20DRS%20and%20VMotion" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2008%2f01%2f20%2fcpu-spike-with-drs-and-vmotion%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2007/06/19/more-on-cpu-masking/">More on CPU Masking</a> <span class="post-date-list">199 May 191919</span></li><li><a href="/2008/01/14/proving-vmware-over-nfs/">Proving VMware Over NFS</a> <span class="post-date-list">149 May 141414</span></li><li><a href="/2008/01/10/esx-server-301-patch-needed-for-vc-25/">ESX Server 3.0.1 Patch Needed for VC 2.5</a> <span class="post-date-list">109 May 101010</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
