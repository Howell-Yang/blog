<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>The Adventures of OmniFocus Bonjour Sync - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="The Adventures of OmniFocus Bonjour Sync - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="The Adventures of OmniFocus Bonjour Sync - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2008/11/02/the-adventures-of-omnifocus-bonjour-sync/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">The Adventures of OmniFocus Bonjour Sync</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 29 May 2022 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/explanation">Explanation</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;987 words (estimated 5 minutes to read)</span>
  <p>I&rsquo;ve made no secret of the fact that I use and enjoy <a href="http://www.omnigroup.com/applications/omnifocus/">OmniFocus</a>, a GTD application from the fine folks at OmniGroup. (Just for the record, I also use and enjoy <a href="http://www.omnigroup.com/applications/omnigraffle/">OmniGraffle</a> and <a href="http://www.omnigroup.com/applications/omnioutliner/">OmniOutliner</a>. Doesn&rsquo;t that qualify me for a free license to <a href="http://www.omnigroup.com/applications/omniplan/">OmniPlan</a>?) In fact, one of the driving factors for purchasing my iPhone&mdash;aside from the fact that it&rsquo;s cool and I wanted one&mdash;was the fact that OmniGroup also had an <a href="http://www.omnigroup.com/applications/omnifocus/iphone/">iPhone version of OmniFocus</a>.</p>
<p>In addition, version 1.5 of OmniFocus for Mac (OF/Mac)&ndash;currently at RC2 status&mdash;will synchronize with OmniFocus for iPhone (OF/iPhone) via MobileMe, WebDAV, or Bonjour on local Wi-Fi. This weekend, version 1.1 of OF/iPhone finally got approved and pushed out to the App Store servers. The new version adds Bonjour sync over local Wi-Fi, meaning that it&rsquo;s now possible to quickly and easily synchronize the OmniFocus database on my laptop with the OmniFocus database on my iPhone. Sweet! (Version 1.1 of OF/iPhone also improves performance and has a few other improvements as well.)</p>
<p>Unfortunately, in the late hours last night, I just couldn&rsquo;t get things to work. No matter how hard I tried, OF/iPhone just wouldn&rsquo;t synchronize with OF/Mac. It would see my laptop advertising via Bonjour, but wouldn&rsquo;t synchronize. My first suspicion proved to be a good one: the IPFW firewall on my laptop. (I use a custom IPFW ruleset in addition to Little Snitch to control traffic moving into and out of my laptop.) I was able to confirm that the firewall was blocking the traffic with this command:</p>
<pre><code>sudo ipfw show
</code></pre>
<p>Sure enough, I saw the default deny rule&rsquo;s counters incrementing every time I tried to synchronize. With this command I quickly disabled the IPFW rules:</p>
<pre><code>sudo ipfw flush
</code></pre>
<p>OK, that got me a bit farther, but OF/iPhone was still reporting an error. The error was different this time, though, so I was convinced that I had made some progress. Unsure of what could be wrong next, I tested a hunch and logged into the Squid proxy server that controls outbound HTTP/HTTPS traffic and checked the access logs. Bingo&mdash;OF/iPhone was hitting the proxy every time I tried to synchronize. But how to fix that? My network is configured such that the Cisco PIX firewall won&rsquo;t allow any traffic out that doesn&rsquo;t first go through the Squid proxy, so turning the proxy settings off on my iPhone would be a temporary fix at best. Nevertheless, to test my settings I disabled the proxy settings on the iPhone (under Settings &gt; Wi-Fi and scroll all the way to the bottom). That did it&mdash;OF/iPhone was now able to synchronize with my laptop. Rather quickly, too, might I add, which is a definite improvement over the WebDAV setup I&rsquo;d been using previously.</p>
<p>But I was still left with two problems: a) the firewall on my laptop was disabled; and b) the proxy settings on my iPhone were disabled. So I set out to fix those two issues.</p>
<p>Fixing the firewall should be easy, right? Just find out what port OF/Mac listens on and create a firewall rule to allow the traffic. It would be easy, <em>except</em> for the fact that the port on which OF/Mac listens changes every time the application launches. OmniGroup, if you&rsquo;re listening: change this to a static port, PLEASE! Or at least provide some sort of hidden preference that would allow geeks like me to make it use a static port. As it stands right now, I had to use a rule that opens up a broad range of ports. That really, <em>really</em> stinks. OK, firewall issue resolved.</p>
<p>The proxy issue proves to be more challenging. There&rsquo;s no way to configure the proxy to ignore the traffic; that has to be done client side. Unlike the full-blown version of Mac OS X, there&rsquo;s no option in the iPhone to ignore certain network ranges or certain DNS domains. But&mdash;and here&rsquo;s the kicker&mdash;the iPhone does support automatic proxy configuration via a PAC file. So I create a very simple PAC file like this:</p>
<pre><code>function FindProxyForURL(url, host)  
{  
if (isInNet(host, &quot;172.16.1.0&quot;, &quot;255.255.255.0&quot;))  
{  
return &quot;DIRECT&quot;;  
}  
else  
{  
return &quot;PROXY server.domain.com:3128&quot;;  
}  
}
</code></pre>
<p>The first round of testing didn&rsquo;t go so well; the Apache HTTPd configuration on my server didn&rsquo;t allow files with a .PAC extension. Oops! After fixing that problem, testing from my laptop went very well. A few seconds later, I had my iPhone reconfigured with the PAC file. And it worked! I was able to successfully synchronize OF/iPhone with OF/Mac while still maintaing access to Internet-based resources. And since the PIX firewall won&rsquo;t allow traffic direct from the iPhone to the Internet, I know that the proxy is still involved in those connections. Reviewing the Squid proxy&rsquo;s access logs also confirmed that the iPhone was not hitting the proxy during synchronization attempts.</p>
<p>Problem all solved, right? Well&hellip;not exactly. I left the PAC configuration on my laptop until this morning, when I fired up <a href="http://www.adiumx.com/">Adium</a>. Bam! Adium throws an error message stating that it doesn&rsquo;t support PAC files. I reconfigured my laptop back to my old configuration and testing the OF/iPhone-to-OF/Mac synchronization again, and it still worked. It appears that as long as the iPhone&rsquo;s proxy configuration is correct, then the synchronization will work.</p>
<p>So, lessons learned:</p>
<ul>
<li>
<p>OF/Mac uses a dynamically assigned port on which it listens for synchronization requests. This means that users with an IPFW firewall configuration will have to open up a wide range of ports until OmniGroup gives us the option to statically assign a port. (Hint, hint&hellip;)</p>
</li>
<li>
<p>HTTP proxy settings on the iPhone will interfere with OF/iPhone synchronization, but that can be solved with a PAC file as described above.</p>
</li>
</ul>
<p>Other than this adventure, I am thus far quite pleased with the update to OF/iPhone. If you are unhappy with the earlier version&mdash;the most common complaint was speed, or lack thereof&mdash;you owe it to yourself to check out version 1.1. It&rsquo;s much improved, in my opinion.</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/apple">Apple</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/iphone">iPhone</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/macos">macOS</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/networking">Networking</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/wireless">Wireless</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2008/10/29/is-power-the-key-to-controlling-the-cloud/">Is Power the Key to Controlling the Cloud?</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2008/11/02/a-couple-more-articles-published-2/">A Couple More Articles Published</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2008%2f11%2f02%2fthe-adventures-of-omnifocus-bonjour-sync%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2008%2f11%2f02%2fthe-adventures-of-omnifocus-bonjour-sync%2f&text=The%20Adventures%20of%20OmniFocus%20Bonjour%20Sync" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2008%2f11%2f02%2fthe-adventures-of-omnifocus-bonjour-sync%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2008/03/06/activesync-on-the-iphone/">ActiveSync on the iPhone</a> <span class="post-date-list">69 May 6066</span></li><li><a href="/2007/09/27/apple-and-vmwareor-xen/">Apple and VMware...or Xen?</a> <span class="post-date-list">279 May 272727</span></li><li><a href="/2008/10/23/this-is-what-snow-leopard-needs/">This is What Snow Leopard Needs</a> <span class="post-date-list">239 May 232323</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
