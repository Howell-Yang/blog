<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Just in Case - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="Just in Case - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="Just in Case - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2005/10/08/just-in-case/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">Just in Case</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 89 May 8088 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/information">Information</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;462 words (estimated 3 minutes to read)</span>
  <p>I&rsquo;ve mentioned the bug discussed in <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;905809">KB905809</a> several times in this blog. In reading those posts (or reading the KB article), you&rsquo;ve probably seen that you can use the <code>SC.EXE</code> command to set the security descriptors on the Service Control Manager to fix the bug. What happens, though, if you mess up the <code>SC.EXE</code> command?</p>
<p>It turns out that this very thing happened recently. A systems administrator copied the required <code>SC.EXE</code> command line from a Word document, thinking it was safer to copy and paste than try to type the command line directly. As it turns out, the copied text from Word had a carriage return in it, and this caused the command line to terminate early (before all the security descriptors were applied). In fact, what happened is that all of the &ldquo;Write&rdquo; permissions were removed.</p>
<p>If you run <code>sc sdshow scmanager</code> on a system running Windows Server 2003 SP1, you&rsquo;ll get this:</p>
<p><code>D:(A;;CC;;;AU)(A;;CCLCRPRC;;;IU)(A;;CCLCRPRC;;;SU)</code><br>
<code>(A;;CCLCRPWPRC;;;SY)(A;;KA;;;BA)S:(AU;FA;KA;;;WD)</code><br>
<code>(AU;OIIOFA;GA;;;WD)</code></p>
<p>(Side note: The first section is the problem area, as this is what grants permission to the Authenticated Users group.  In the fix described in KB905809, this section changes to grant Authenticated Users more permissions.)</p>
<p>In this particular situation, all of the &ldquo;Write&rdquo; permissions&mdash;everything after the <code>(A;;CCLCRPRC;;;SU)</code> section&mdash;was accidentally removed. So, when the administrator realized what had happened and went back to try to fix it the system kicked back an &ldquo;Access Denied&rdquo; error message, because the permissions had been removed. With no permission to change the permissions, what could be done?</p>
<p>Fortunately, we found a fix. This <a href="http://www.exchangeserveradmin.org/ftopic24842_Could_NOT_change_mail_address_after_windows_server_2003_sp1.html">URL</a> describes a Registry key that someone else had concocted trying to fix this very problem. In my discussions with Microsoft Product Support services, they analyzed this Registry hack and determined that the end result was the same as the <code>SC.EXE</code> command. By importing this Registry fix, we were able to restore the permissions that had been inadvertently removed. We then used SC again (with <code>sdshow scmanager</code>) to verify that the permissions were as they needed to be.</p>
<p>We are fortunate that this Registry fix solved the problem. Had the Registry fix not worked, we most likely would have had to rebuild the server in question&mdash;not a pleasant thought given that we had several hundred users already migrated over to that server.</p>
<p>What can we learn from this situation? Here are my thoughts:</p>
<ol>
<li>
<p>Always type your commands by hand, instead of copying and pasting.</p>
</li>
<li>
<p>Take appropriate precautions. In large-scale production environments, pull a hot-plug hard drive from the RAID array first. If things go south, shut the server down and reboot from the pristine drive.</p>
</li>
<li>
<p>When running a command like this, pray.</p>
</li>
</ol>
<p>The real question, in my mind, is this: why isn&rsquo;t Microsoft going to fix this bug? We may never know the answer to that question.</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/activedirectory">ActiveDirectory</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/microsoft">Microsoft</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/security">Security</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2005/10/06/an-interesting-viewpoint/">An Interesting Viewpoint</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2005/10/08/bluetooth-interfering-with-gprs-on-my-treo-650/">Bluetooth Interfering with GPRS on my Treo 650</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2005%2f10%2f08%2fjust-in-case%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2005%2f10%2f08%2fjust-in-case%2f&text=Just%20in%20Case" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2005%2f10%2f08%2fjust-in-case%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2005/08/16/funky-active-directory-issue/">Funky Active Directory Issue</a> <span class="post-date-list">169 May 161616</span></li><li><a href="/2005/09/26/error-id-c10308a2-is-put-to-rest/">Error ID c10308a2 is Put to Rest</a> <span class="post-date-list">269 May 262626</span></li><li><a href="/2005/09/22/have-you-seen-error-id-c10308a2/">Have You Seen Error ID c10308a2?</a> <span class="post-date-list">229 May 222222</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
