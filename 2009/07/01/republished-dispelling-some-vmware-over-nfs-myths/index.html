<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Republished: Dispelling Some VMware over NFS Myths - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="Republished: Dispelling Some VMware over NFS Myths - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="Republished: Dispelling Some VMware over NFS Myths - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2009/07/01/republished-dispelling-some-vmware-over-nfs-myths/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">Republished: Dispelling Some VMware over NFS Myths</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 19 May 1011 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/rant">Rant</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;798 words (estimated 4 minutes to read)</span>
  <p><em>Author&rsquo;s Note: This content was first published over at <a href="http://www.storagemonkeys.com">Storage Monkeys</a>, but it appears that it has since disappeared and is no longer available. For that reason, I&rsquo;m republishing it here (with minor edits). Where applicable, I&rsquo;ll also be republishing other old content from that site in the coming weeks. Thanks!</em></p>
<p>In this article, I&rsquo;m going to tackle what will probably be a sensitive topic for some readers: VMware over NFS. All across the Internet, I run into article after article after article that sings the praises of NFS for VMware. Consider some of the following examples:</p>
<ul>
<li>
<p><a href="http://www.vifaq.com/index.php?option=com_content&amp;task=view&amp;id=25&amp;Itemid=2">VMware over NFS - Why?</a></p>
</li>
<li>
<p><a href="http://viroptics.blogspot.com/2007/11/why-vmware-over-netapp-nfs.html">Why VMware over NetApp NFS</a></p>
</li>
<li>
<p><a href="http://www.vm-aware.com/2008/02/28/vmware-nfs/">VMware &amp; NFS</a></p>
</li>
</ul>
<p>That first link looks to be mostly a reprint of <a href="http://storagefoo.blogspot.com/2007/09/vmware-over-nfs.html">this blog post by Nick Triantos</a>. Now, Nick is a solid storage engineer; there is no question in my mind that he knows Fibre Channel, iSCSI, and NFS inside out. Nick is certainly someone who is more than qualified to speak to the validity of using NFS for VMware storage. <em>But&hellip;</em></p>
<p>I am going to have to disagree with some of the statements that are being propagated about NFS for VMware storage. Is NFS for VMware environments a valid choice? Yes, absolutely. However, there are some myths about NFS for VMware storage that need to be addressed.</p>
<ol>
<li>
<p><em><strong>Myth #1: All VMDKs are thin provisioned by default with NFS, and that saves significant amounts of storage space.</strong></em> That&rsquo;s true&mdash;to a certain point. What I pointed out back in March of 2008, though, was that these VMDKs are <a href="/2008/03/31/only-thin-provisioned-in-the-beginning/">only thin provisioned at the beginning</a>. What does that mean? Perform a Storage VMotion operation to move those VMDKs from one NFS datastore to a different NFS datastore, and the VMDK will inflate to become a thick provisioned file. Clone another VM from the VM with the thin provisioned disks, and you&rsquo;ll find that the cloned VM has thick VMDKs. That&rsquo;s right&mdash;the only way to get those thin provisioned VMDKs is to create all your VMs from scratch. Is that what you really want to do? <em>(Note: VMware vSphere now supports thin provisioned VMDKs on all storage platforms, and corrects the issues with thin provisioned VMDKs inflating due to a Storage VMotion or cloning operation, so this point is somewhat dated.)</em></p>
</li>
<li>
<p><em><strong>Myth #2: NFS uses Ethernet as the transport, so I can just add more network connections to scale the bandwidth.</strong></em> Well, not exactly. Yes, it is possible to add Ethernet links and get more bandwidth. However, you&rsquo;ll have to deal with a whole list of issues: link aggregation/802.3ad, physical switch redundancy (which is further complicated when you want to use link aggregation/802.3ad), multiple IP addresses on the NFS server(s), multiple VMkernel ports on the VMware ESX servers, and multiple IP subnets. Let&rsquo;s just say that scaling NFS bandwidth with VMware ESX isn&rsquo;t as straightforward as it may seem. This article I wrote back in July of 2008 may help shed some light on the particulars that are involved when it comes to <a href="/2008/07/16/understanding-nic-utilization-in-vmware-esx/">ESX and NIC utilization</a>.</p>
</li>
<li>
<p><em><strong>Myth #3: Performance over NFS is better than Fibre Channel or iSCSI.</strong></em> Based on <a href="http://media.netapp.com/documents/tr-3697.pdf">this technical report by NetApp</a>&ndash;no doubt one of the biggest proponents of NFS for VMware storage&mdash;NFS performance trails Fibre Channel, although by less than 10%. So, performance is comparable in almost all cases, and the difference is small enough not to be noticeable. The numbers do not, however, indicate that NFS is better than Fibre Channel. You can read my views on <a href="/2008/08/14/storage-protocol-performance-whitepaper-from-netapp/">this storage protocol comparison</a> at my site. By the way, also check the comments; you&rsquo;ll see that the results in the technical report were independently verified by VMware as well. Based on this information, someone could certainly say that NFS performance is perfectly reasonable, but one could not say that NFS performance is better than Fibre Channel.</p>
</li>
</ol>
<p>Now, one might look at this article and say, &ldquo;Scott, you hate NFS!&rdquo; No, actually, I <em>like</em> using NFS for VMware Infrastructure implementations, and here&rsquo;s why:</p>
<ul>
<li>
<p>Provisioning is a breeze. It&rsquo;s dead simple to add NFS datastores.</p>
</li>
<li>
<p>You can easily (depending upon the storage platform) increase or decrease the size of NFS datastores. Try decreasing the size of a VMFS datastore and see what happens!</p>
</li>
<li>
<p>You don&rsquo;t need to deal with the complexity of a Fibre Channel fabric, switches, WWNs, zones, ISLs, and all that. Now, there is some complexity involved (see Myth #2 above), but it&rsquo;s generally easier than Fibre Channel. Unless you&rsquo;re a Fibre Channel expert, of course&hellip;</p>
</li>
</ul>
<p>So there <em>are</em> some tangible benefits to using NFS for VMware Infrastructure. But let&rsquo;s be real about this, and not try to gloss over technical details. While NFS has some real advantages, it also has some real disadvantages, and organizations choosing a storage protocol need to understand both sides of the coin.</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/nfs">NFS</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/storage">Storage</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/virtualization">Virtualization</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/vmware">VMware</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2009/06/30/thinking-out-loud-why-deploy-fcoe/">Thinking Out Loud: Why Deploy FCoE?</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2009/07/02/a-comment-policy-reminder/">A Comment Policy Reminder</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2009%2f07%2f01%2frepublished-dispelling-some-vmware-over-nfs-myths%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2009%2f07%2f01%2frepublished-dispelling-some-vmware-over-nfs-myths%2f&text=Republished%3a%20Dispelling%20Some%20VMware%20over%20NFS%20Myths" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2009%2f07%2f01%2frepublished-dispelling-some-vmware-over-nfs-myths%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2009/05/21/vmware-vsphere-vds-vmkernel-ports-and-jumbo-frames/">VMware vSphere vDS, VMkernel Ports, and Jumbo Frames</a> <span class="post-date-list">219 May 212121</span></li><li><a href="/2009/04/08/3010-a-multistore-primer/">3010: A MultiStore Primer</a> <span class="post-date-list">89 May 8088</span></li><li><a href="/2009/03/31/storage-alignment-document/">Storage Alignment Document</a> <span class="post-date-list">319 May 313131</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
