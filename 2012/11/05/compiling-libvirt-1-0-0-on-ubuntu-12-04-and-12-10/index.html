<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Compiling libvirt 1.0.0 on Ubuntu 12.04 and 12.10 - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="Compiling libvirt 1.0.0 on Ubuntu 12.04 and 12.10 - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="Compiling libvirt 1.0.0 on Ubuntu 12.04 and 12.10 - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2012/11/05/compiling-libvirt-1-0-0-on-ubuntu-12-04-and-12-10/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">Compiling libvirt 1.0.0 on Ubuntu 12.04 and 12.10</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 59 May 5055 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/tutorial">Tutorial</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;541 words (estimated 3 minutes to read)</span>
  <p>In case you hadn&rsquo;t noticed late last week, the open source virtualization API project <a href="http://libvirt.org">libvirt</a> released version 1.0.0&ndash;a major milestone, obviously. To celebrate the 1.0.0 release, here are instructions for compiling the libvirt 1.0.0 release on Ubuntu 12.04 and 12.10.</p>
<p>(If you need instructions on compiling an earlier release of libvirt on Ubuntu, see <a href="/2012/09/07/compiling-libvirt-0-10-1-on-ubuntu-12-04/">this post</a>. It works for libvirt 0.10.1 and 0.10.2 on Ubuntu 12.04 LTS; I haven&rsquo;t yet tested it on Ubuntu 12.10.)</p>
<p>These instructions assume that you have built a plain-jane Ubuntu system (either 12.04 LTS or 12.10). I tested these instructions on an Ubuntu 12.04.1 LTS VM, freshly built and updated using <code>apt-get update &amp;&amp; apt-get upgrade</code>, on a freshly-built Ubuntu 12.10 VM (also up to date), and a physical system running an up-to-date instance of Ubuntu 12.04.1 that also had KVM and an earlier version of libvirt installed. These instructions worked in all three cases.</p>
<p>Ready? Let&rsquo;s get started!</p>
<ol>
<li>
<p>Download the libvirt-1.0.0.tar.gz tarball from the <a href="http://libvirt.org/sources/">libvirt.org HTTP server</a>.</p>
</li>
<li>
<p>Extract the tarball using <code>tar -xvzf libvirt-1.0.0.tar.gz</code>.</p>
</li>
<li>
<p>Using <code>apt-get</code>, ensure that the following packages are installed: gcc, make, pkg-config (already installed in my testing), libxml2-dev, libgnutls-dev, libdevmapper-dev, libcurl4-gnutls-dev, and python-dev. (Interestingly enough, earlier versions also required libyajl-dev, but this version didn&rsquo;t seem to need it.) You can probably omit the libcurl4-gnutls-dev package if you don&rsquo;t want ESX support; I did want ESX support, so I included it.</p>
</li>
<li>
<p>From within the extracted libvirt-1.0.0 directory, run the <code>configure</code> command. I specified particular directories because that&rsquo;s where the prebuilt binaries from Ubuntu are normally placed, so the final command was <code>./configure --prefix=/usr --localstatedir=/var --sysconfdir=/etc --with-esx=yes</code>.</p>
</li>
<li>
<p>The above command does <em>not</em> include Xen support; if you need Xen support, you&rsquo;ll need to add <code>--with-xen=yes</code> to the command, and your list of prerequisite packages will change (there are additional packages you&rsquo;ll need to install).</p>
</li>
<li>
<p>Once the <code>configure</code> command completes, then complete the process with <code>make</code> and <code>make install</code>. Note that I used <code>sudo make install</code> here because I&rsquo;m installing files into privileged system locations.</p>
</li>
<li>
<p>Finally, to verify that everything seems to be working as expected, restart libvirt with <code>initctl stop libvirt-bin</code> and <code>initctl start libvirt-bin</code>. (Yes, you could use <code>initctl restart</code>, but this allows you to see the clean stop and start of the libvirt daemon.) As an aside, note that this step only works if you either a) had a previous version of libvirt installed, or b) create the <code>initctl</code> job for libvirt. I chose the first approach.</p>
</li>
<li>
<p>As a final verification step, run <code>virsh --version</code> or <code>libvirtd --version</code> to verify that you&rsquo;re running libvirt 1.0.0.</p>
</li>
</ol>
<p>That&rsquo;s it! Now, as others have pointed out, this will create some potential system administration challenges, in that <code>apt-get</code> will still suggest new libvirt packages to install when you try to update the system. I <em>think</em> that there are some commands you can run to keep the manually compiled version instead of the version <code>apt-get</code> is suggesting, but I haven&rsquo;t yet determined exactly which commands to use. (If you have more information, please speak up in the comments!)</p>
<p>I have a series of new libvirt-related blog posts in the works, so stay tuned for those. In the meantime, feel free to post any questions, corrections, or clarifications in the comments below. Courteous comments are always welcome.</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/interoperability">Interoperability</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/libvirt">Libvirt</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/linux">Linux</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/oss">OSS</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/ubuntu">Ubuntu</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/virtualization">Virtualization</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2012/10/31/layer-3-routing-with-open-vswitch/">Layer 3 Routing with Open vSwitch</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2012/11/06/a-quick-warning-about-compiling-libvirt/">A Quick Warning About Compiling libvirt</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2012%2f11%2f05%2fcompiling-libvirt-1-0-0-on-ubuntu-12-04-and-12-10%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2012%2f11%2f05%2fcompiling-libvirt-1-0-0-on-ubuntu-12-04-and-12-10%2f&text=Compiling%20libvirt%201.0.0%20on%20Ubuntu%2012.04%20and%2012.10" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2012%2f11%2f05%2fcompiling-libvirt-1-0-0-on-ubuntu-12-04-and-12-10%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2012/10/23/why-mess-around-with-libvirt/">Why Mess Around with libvirt?</a> <span class="post-date-list">239 May 232323</span></li><li><a href="/2012/10/22/wrapping-libvirt-virtual-networks-around-open-vswitch-fake-bridges/">Wrapping libvirt Virtual Networks Around Open vSwitch Fake Bridges</a> <span class="post-date-list">229 May 222222</span></li><li><a href="/2012/09/07/compiling-libvirt-0-10-1-on-ubuntu-12-04/">Compiling libvirt 0.10.1 on Ubuntu 12.04</a> <span class="post-date-list">79 May 7077</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
