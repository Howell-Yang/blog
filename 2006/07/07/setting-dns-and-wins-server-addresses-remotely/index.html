<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Setting DNS and WINS Server Addresses Remotely - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="Setting DNS and WINS Server Addresses Remotely - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="Setting DNS and WINS Server Addresses Remotely - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2006/07/07/setting-dns-and-wins-server-addresses-remotely/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">Setting DNS and WINS Server Addresses Remotely</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 79 May 7077 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/education">Education</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;574 words (estimated 3 minutes to read)</span>
  <p>As a follow-up to yesterday&rsquo;s posting about using <a href="/2006/07/06/remotely-setting-the-dns-suffix-search-order/">WMIC to set the DNS suffix search order remotely</a>, here&rsquo;s additional information on using WMIC to remotely set the DNS server and WINS server addresses. This technique can be particularly useful for servers, where the IP addresses are statically assigned (as opposed to configured via DHCP).</p>
<p><strong>WARNING:</strong> There are some limitations to this technique, so don&rsquo;t unleash it on your network without first taking the time to understand what it is doing and what the effects will be. Don&rsquo;t come crying to me if you mass configure all your servers and your network breaks&mdash;you&rsquo;ve been warned.</p>
<p>The trick to this technique is understanding that WMIC has to work on a specific NIC instance in order to make this change. The DNS suffix search order, on the other hand, does not need to be applied to a specific NIC instance.</p>
<p>This command assumes that all IP-enabled, statically assigned interfaces should have their DNS and/or WINS server addresses changed. In this case, we&rsquo;re leveraging the power of WMIC&rsquo;s SQL-like <code>where</code> clause to limit our activity to only specific NIC instances.</p>
<p>Here&rsquo;s the command to set the WINS server addresses:</p>
<pre><code>wmic nicconfig where (IPEnabled=TRUE and DHCPEnabled=FALSE) 
call SetWINSServer &quot;192.168.254.100&quot;,&quot;192.168.254.101&quot;
</code></pre>
<p>To perform this command remotely, add the <code>/node:&lt;PC name&gt;</code> switch (this goes before <code>nicconfig</code>). To specify alternate user credentials, add <code>/user:&lt;Username&gt;</code> and <code>/password:&lt;Password&gt;</code> switches (again, before nicconfig). Note the <code>where</code> clause that limits the action to only those NICs that are IP-enabled and not using DHCP.</p>
<p>Here&rsquo;s the command to set the DNS server addresses:</p>
<pre><code>wmic nicconfig where (IPEnabled=TRUE and DHCPEnabled=FALSE) 
call SetDNSServerSearchOrder (&quot;192.168.254.101&quot;,&quot;192.168.254.100&quot;)
</code></pre>
<p>The syntax is slightly different here for DNS servers than above for WINS server, so don&rsquo;t get tripped up. Same things apply again for working against a remote node or for specifying alternate user credentials.</p>
<p>Refer back to the entry on <a href="/2006/07/06/remotely-setting-the-dns-suffix-search-order/">setting the DNS suffix search order</a> for techniques on how to provide WMIC with a list of computers to act against (either embedding in a <code>for /f</code> command or using the <code>/node:@filename</code> trick). Using either of these techniques would let you apply these changes to a number of computers all at once.</p>
<p><strong>WARNING:</strong> It should go without saying that setting either or both of these configuration values can, if done incorrectly, have a negative impact on the operation of your network. Specifically, it may not work <em>at all.</em> Exercise caution and make sure you know exactly which computers are going to be affected by this command. For this reason I would recommend against using the output of a Dsquery command with this WMIC command.</p>
<p>There are some important things to note about this command:</p>
<ul>
<li>
<p>First, the command works against <em>all</em> IP-enabled, statically assigned NICs on the computer. If the computer has multiple NICs (i.e., is multihomed), this command will affect all of them&mdash;at least, all of them that match the criteria. This may not be the desired effect.</p>
</li>
<li>
<p>Second, both the primary and secondary WINS servers have to be specified. I haven&rsquo;t figured out how to set only the primary WINS server or only the secondary WINS server yet.</p>
</li>
</ul>
<p>With those limitations in mind, I hope that someone finds this information helpful. I don&rsquo;t think I can describe how many times I&rsquo;ve had to go back and reconfigure servers with new DNS IP addresses or new WINS IP addresses, and when the number of servers gets up there that process gets real tedious real fast.</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/microsoft">Microsoft</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/networking">Networking</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/windows">Windows</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2006/07/06/remotely-setting-the-dns-suffix-search-order/">Remotely Setting the DNS Suffix Search Order</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2006/07/10/iscsi-and-esx-server-3/">iSCSI and ESX Server 3</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2006%2f07%2f07%2fsetting-dns-and-wins-server-addresses-remotely%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2006%2f07%2f07%2fsetting-dns-and-wins-server-addresses-remotely%2f&text=Setting%20DNS%20and%20WINS%20Server%20Addresses%20Remotely" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2006%2f07%2f07%2fsetting-dns-and-wins-server-addresses-remotely%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2006/07/06/mass-renaming-computers/">Mass Renaming Computers</a> <span class="post-date-list">69 May 6066</span></li><li><a href="/2006/06/28/automating-static-entries-in-wins/">Automating Static Entries in WINS</a> <span class="post-date-list">289 May 282828</span></li><li><a href="/2006/04/27/linux-ad-integration-with-windows-server-2003-r2/">Linux-AD Integration With Windows Server 2003 R2</a> <span class="post-date-list">279 May 272727</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
