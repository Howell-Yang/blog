<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>VM Portability Again - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="VM Portability Again - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="VM Portability Again - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2006/12/06/vm-portability-again/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">VM Portability Again</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 69 May 6066 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/explanation">Explanation</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;425 words (estimated 2 minutes to read)</span>
  <p>The idea was to take a VM running <a href="http://www.microsoft.com/windowsserver/default.mspx">Windows Server 2003 R2</a> off one of the ESX servers and port it over to VMware Fusion on my <a href="http://www.apple.com/macbookpro/">MacBook Pro</a>. If that worked (and I fully expected that it would), then I&rsquo;d try reversing the process. In particular, I&rsquo;d love to move that same VM I moved last week over to the VI3 server farm from my MBP (it&rsquo;s running the NetApp Data ONTAP Simulator and I could <em>really</em> use it running on the servers). This attempt would be a precursor to that attempt.</p>
<p>First, the VMDK had to be exported out of the VMFS datastore into 2GB sparse format (the format used by VMware products other than ESX Server). In my case, that meant exporting a 4GB VMDK out of an iSCSI VMFS datastore to the local filesystem.</p>
<p>The command for that is:</p>
<pre><code>vmkfstools -i /path/to/src/vmdk /path/to/final/vmdk -d 2gbsparse
</code></pre>
<p>Of course, this line needs to be typed all on a single line, but you already know that. (Long-time ESX users will note that the <code>vmkfstools -i</code> listed above is the replacement for the now-deprecated <code>vmkfstools -e</code> command that was used in ESX 2.x and earlier.)</p>
<p>Once the data was available outside the VMFS datastore, I just need to get the data down to my MBP. <a href="http://cyberduck.ch/">Cyberduck</a>, an open source SFTP client for <a href="http://www.apple.com/macosx/">Mac OS X</a>, filled that need quite handily, and a while later I had the 3.0GB of data on my laptop.</p>
<p>VMware Fusion opened the .VMX file without any major complaints and promptly booted the VM, notifying me that it needed to create a new UUID, that the CMOS was invalid (I think this is a VMware Fusion bug, actually, since I get this for all new VMs created with Fusion), and that it couldn&rsquo;t load the networking. Ah, yes, I had forgotten that VMware Fusion only supports NAT networking at this stage of development.</p>
<p>I removed these two lines from the .VMX file:</p>
<pre><code>ethernet0.networkName = &quot;Lab&quot;
ethernet0.addressType = &quot;vpx&quot;
</code></pre>
<p>And added this line:</p>
<pre><code>ethernet0.connectionType = &quot;nat&quot;
</code></pre>
<p>Upon rebooting the VM, no more warning messages. The VM booted up and everything seemed to work just fine. (There were some OS-specific issues, as this was a domain controller and now could no longer reach the domain, but those were to be expected in this kind of situation.)</p>
<p>Now the trick is to go the other way&hellip;to take a VM I have on VMware Fusion and push it up to ESX Server. I&rsquo;ll post more information here when I&rsquo;ve had a chance to try that.</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/esx">ESX</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/macintosh">Macintosh</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/virtualization">Virtualization</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/vmware">VMware</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2006/12/06/word-zero-day-attack-alert/">Word Zero-Day Attack Alert</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2006/12/07/8021x-integration-with-active-directory/">802.1x Integration with Active Directory</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2006%2f12%2f06%2fvm-portability-again%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2006%2f12%2f06%2fvm-portability-again%2f&text=VM%20Portability%20Again" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2006%2f12%2f06%2fvm-portability-again%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2006/12/05/the-future-of-the-os/">The Future of the OS</a> <span class="post-date-list">59 May 5055</span></li><li><a href="/2006/11/29/solaris-10-x86-on-mac-os-x/">Solaris 10 x86 on Mac OS X</a> <span class="post-date-list">299 May 292929</span></li><li><a href="/2006/08/07/vmware-on-mac-os-x/">VMware on Mac OS X</a> <span class="post-date-list">79 May 7077</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
