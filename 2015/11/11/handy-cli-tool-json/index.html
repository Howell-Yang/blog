<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>A Handy CLI Tool for Working with JSON - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="A Handy CLI Tool for Working with JSON - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="A Handy CLI Tool for Working with JSON - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2015/11/11/handy-cli-tool-json/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">A Handy CLI Tool for Working with JSON</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 119 May 111111 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/education">Education</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;516 words (estimated 3 minutes to read)</span>
  <p>While I was at <a href="https://kubecon.io">Kubecon</a> this past week, one of the presenters showed off a handy CLI tool for working with JSON. It&rsquo;s called <a href="https://stedolan.github.io/jq/"><code>jq</code></a>, and in this post I&rsquo;m going to show you a few ways to use <code>jq</code>. For the source of JSON output, I&rsquo;ll use the <a href="http://www.openstack.org/">OpenStack</a> APIs.</p>
<p>If you&rsquo;re not familiar with JSON, I suggest having a look at <a href="/2013/11/08/a-non-programmers-introduction-to-json/">this non-programmer&rsquo;s introduction to JSON</a>. Also, refer to this article on <a href="/2014/02/19/using-curl-to-interact-with-a-restful-api/">using cURL to interact with a RESTful API</a> for a bit more background on some of the commands I&rsquo;m going to use in this post.</p>
<p>Let&rsquo;s start by getting an authorization token for OpenStack, using the following <code>curl</code> command:</p>
<pre><code>curl -d '{&quot;auth&quot;:{&quot;passwordCredentials&quot;:\
{&quot;username&quot;: &quot;admin&quot;,&quot;password&quot;: &quot;secret&quot;},\
&quot;tenantName&quot;: &quot;customer-A&quot;}}' \
-H &quot;Content-Type: application/json&quot; \
http://192.168.100.100:5000/v2.0/tokens
</code></pre>
<p>This will return a pretty fair amount of JSON in the response, and it presents the first opportunity to use <code>jq</code>. Let&rsquo;s say you <em>only</em> wanted the authorization token, and not all the other output. Simply add the following <code>jq</code> command to the end of your <code>curl</code> request:</p>
<pre><code>curl -d '{&quot;auth&quot;:{&quot;passwordCredentials&quot;:\
{&quot;username&quot;: &quot;admin&quot;,&quot;password&quot;: &quot;secret&quot;},\
&quot;tenantName&quot;: &quot;customer-A&quot;}}' \
-H &quot;Content-Type: application/json&quot; \
http://192.168.100.100:5000/v2.0/tokens | \
jq '.[].token.id'
</code></pre>
<p>This is just the tip of the iceberg for <code>jq</code>, though. Now that you have a token, let&rsquo;s get the list of tenants:</p>
<pre><code>curl -H &quot;X-Auth-Token: &lt;Value from previous command&gt;&quot; \
-H &quot;Content-Type: application/json&quot; \
http://192.168.100.100:5000/v2.0/tenants
</code></pre>
<p>This gives you another opportunity show off what <code>jq</code> can do. We&rsquo;re primarily only interested in the name and ID of the tenants, so you can use <code>jq</code> to &ldquo;reformat&rdquo; the JSON output from OpenStack to include only that information. That&rsquo;s done with this snippet:</p>
<pre><code>curl -H &quot;X-Auth-Token: &lt;Value from previous command&gt;&quot; \
-H &quot;Content-Type: application/json&quot; \
http://192.168.100.100:5000/v2.0/tenants | \
jq '.tenants[] | {name: .name, uuid: .id}'
</code></pre>
<p>This will provide output that will look something like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;customer-A&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;uuid&#34;</span>: <span style="color:#e6db74">&#34;2c9dfbd9f1be3e88c56c88e1e6f38b85&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;customer-B&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;uuid&#34;</span>: <span style="color:#e6db74">&#34;e7c59d569a894d42943417f7b6d2931a&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This makes it really easy to parse out the specific information you need.</p>
<p>Now that you&rsquo;re armed with both an authorization token and a tenant ID, you can ask OpenStack to list the instances belonging to a tenant:</p>
<pre><code>curl -H &quot;X-Auth-Token: &lt;Value from previous command&gt;&quot; \
-H &quot;Content-Type: application/json&quot;
http://192.168.100.100:8774/v2/&lt;Tenant ID&gt;/servers
</code></pre>
<p>And once again, we can use <code>jq</code> to easily pull out just the information we want:</p>
<pre><code>curl -H &quot;X-Auth-Token: &lt;Value from previous command&gt;&quot; \
-H &quot;Content-Type: application/json&quot; \
http://192.168.100.100:8774/v2/&lt;Tenant ID&gt;/servers | \
jq '.servers[] | {name: .name, uuid: .id}'
</code></pre>
<p>This will pull out only the name and ID of the servers returned by the API call. Using one of the IDs returned by the call, you can then gather information about that instance, and use <code>jq</code> to format (pretty print) the resulting output:</p>
<pre><code>curl -H &quot;X-Auth-Token: &lt;Value from previous command&gt;&quot; \
-H &quot;Content-Type: application/json&quot; \
http://192.168.100.100:8774/v2/&lt;Tenant ID&gt;/servers/&lt;server ID&gt; | \
jq '.'
</code></pre>
<p>(For this last use case, you could also use <code>python -m json.tool</code>.)</p>
<p>Anyway, there&rsquo;s a ton more that you can do with <code>jq</code>, and I&rsquo;m still discovering all the various uses myself. Be sure to check out <a href="https://stedolan.github.io/jq/tutorial/">the tutorial</a> and <a href="https://stedolan.github.io/jq/manual/">the manual</a> for more information.</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/json">JSON</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/oss">OSS</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/cli">CLI</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2015/11/09/changing-passwords-cloud-init/">Changing Passwords with cloud-init</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2015/11/13/busycal-and-textual/">BusyCal and Textual</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2015%2f11%2f11%2fhandy-cli-tool-json%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2015%2f11%2f11%2fhandy-cli-tool-json%2f&text=A%20Handy%20CLI%20Tool%20for%20Working%20with%20JSON" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2015%2f11%2f11%2fhandy-cli-tool-json%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2014/08/18/coreos-continued-etcd/">CoreOS Continued: etcd</a> <span class="post-date-list">189 May 181818</span></li><li><a href="/2014/11/06/setting-up-the-tools-for-contributing-to-openstack-documentation/">Setting up the Tools for Contributing to OpenStack Documentation</a> <span class="post-date-list">69 May 6066</span></li><li><a href="/2014/08/20/coreos-continued-fleet-and-docker/">CoreOS Continued: Fleet and Docker</a> <span class="post-date-list">209 May 202020</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
