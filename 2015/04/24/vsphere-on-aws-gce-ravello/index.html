<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Running vSphere on AWS or GCE - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="Running vSphere on AWS or GCE - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="Running vSphere on AWS or GCE - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2015/04/24/vsphere-on-aws-gce-ravello/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">Running vSphere on AWS or GCE</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 249 May 242424 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/news">News</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;720 words (estimated 4 minutes to read)</span>
  <p>By now you&rsquo;ve probably seen or heard the news about Ravello Systems launching Inception&mdash;the ability to run nested VMware ESXi on AWS or GCE, including the ability to run VMs on these nested ESXi instances. (<a href="http://www.ravellosystems.com/news/nested-esxi-cloud-launch">Here&rsquo;s Ravello&rsquo;s press release.</a>)</p>
<p>In my opinion, this is pretty cool, and it opens the door to a <em>lot</em> of different possibilities: upgrade testing, automation testing, new feature testing, hosted home labs (aka &ldquo;Lab as a Service&rdquo;). Lots of folks are interested in using this new Ravello functionality for &ldquo;Lab as a Service.&rdquo; <a href="http://vinfrastructure.it/2015/04/ravello-system-and-its-lab-as-a-service-solution/">Here&rsquo;s Andrea Mauro&rsquo;s take on this topic.</a></p>
<p>As part of the pre-launch activities, a number of bloggers and community advocates were able to work with Ravello on some very interesting projects:</p>
<ul>
<li>William Lam built both a 32-node VSAN cluster (running vSphere 5.5) as well as a 64-node VSAN cluster (running vSphere 6.0). He posted details <a href="http://www.virtuallyghetto.com/2015/04/running-nested-esxi-vsan-home-lab-on-ravello.html">here</a>, along with a great walkthrough of setting up vSphere on Ravello.</li>
<li>Mike Preston built out an environment that allowed him <a href="http://blog.mwpreston.net/2015/04/15/a-google-cloud-to-amazon-vmotion-the-ravello-way/">to perform a vMotion from AWS to GCE</a>.</li>
</ul>
<p>I was also engaged with Ravello on a project: building a (reasonably) large-scale vSphere environment on Ravello. The original goal was to spin up 500 virtual ESXi hosts, each running 2 or 3 VMs, to help show the scalability and stability of the Inception offering. The design that I created for the Ravello team to use was a pretty standard design:</p>
<ul>
<li>The ESXi hosts would be run in clusters, starting small and eventually scaling to 8 clusters of approximately 64 hosts.</li>
<li>Because NIC redundancy wouldn&rsquo;t be an issue, the virtual ESXi hosts each had two network interfaces.</li>
<li>The environment would use Host Profiles to help with configuration of the ESXi hosts.</li>
<li>Both network interfaces on the ESXi hosts were connected to a vSphere Distributed Switch.</li>
<li>VCSA would manage the environment. To help avoid any potential interactions resulting from running VCSA on the environment it was managing, I recommended a separate management cluster.</li>
<li>The environment would use a &ldquo;home grown&rdquo; VSA running NFS for VM storage. Initially, because we were unclear how well this makeshift VSA would perform, the plan was to have a VSA for each cluster.</li>
</ul>
<p>As you can see, the design is pretty straightforward. As is often the case, the actual implementation ended up looking a bit different than the original design in a couple of ways:</p>
<ol>
<li>Using New Relic, the Ravello team was able to monitor the performance of the home-grown VSA, and it held up remarkably well. Instead of using a separate VSA for each cluster, we ended up with a single VSA for the entire environment.</li>
<li>The implementation team ended up skipping the separate management cluster and running the VCSA directly on the same hosts it was managing. This did not introduce any issues or problems, but was a deviation from the original design.</li>
</ol>
<p><a href="http://www.ravellosystems.com/blog/250-node-esxi-cloud/">This blog post from Ravello</a> describes in more detail the specific steps that were taken to build the environment. Note that very little of what is documented in that blog post is specific to Ravello; most of it pertains to any reasonably sizable vSphere environment.</p>
<p>So, what was the result of our project?</p>
<ul>
<li>We grew the environment to 250 ESXi hosts, not the original 500 that was planned. This was due strictly to time constraints around the timing of the announcement, and not due to any limitation in Ravello&rsquo;s platform. (Although Ravello did find and resolve a couple of issues as a result of the scale testing, thus improving the quality and stability of the offering.)</li>
<li>The singular home-grown NFS VM managed to support approximately 500 VMs. Granted, these VMs generated very little disk traffic, and the NFS VM did suffer from boot storm issues, but we were still a bit surprised that it scaled as far as it did.</li>
<li>The primary bottleneck identified was the VCSA itself, which started having stability and performance issues at the 250-host mark. The Ravello team was going to reconfigure VCSA to see if those issues could be resolved, but (as of this writing) I don&rsquo;t know if that ever happened.</li>
</ul>
<p>All in all, it was a pretty nice project in which to be involved, and it demonstrated Ravello&rsquo;s ability to host sizable vSphere environments through their platform. I&rsquo;m keen to see how the community and the customers use this functionality from Ravello.</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/vmware">VMware</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/vsphere">vSphere</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/cloud">Cloud</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/aws">AWS</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2015/04/24/technology-short-take-50/">Technology Short Take #50</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2015/04/29/ipv6-microsegmentation/">Interop Liveblog: IPv6 Microsegmentation</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2015%2f04%2f24%2fvsphere-on-aws-gce-ravello%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2015%2f04%2f24%2fvsphere-on-aws-gce-ravello%2f&text=Running%20vSphere%20on%20AWS%20or%20GCE" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2015%2f04%2f24%2fvsphere-on-aws-gce-ravello%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2015/03/10/technology-short-take-49/">Technology Short Take #49</a> <span class="post-date-list">109 May 101010</span></li><li><a href="/2015/02/10/technology-short-take-48/">Technology Short Take #48</a> <span class="post-date-list">109 May 101010</span></li><li><a href="/2015/01/07/technology-short-take-47/">Technology Short Take #47</a> <span class="post-date-list">79 May 7077</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
