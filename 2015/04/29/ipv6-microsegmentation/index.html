<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Interop Liveblog: IPv6 Microsegmentation - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="Interop Liveblog: IPv6 Microsegmentation - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="Interop Liveblog: IPv6 Microsegmentation - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2015/04/29/ipv6-microsegmentation/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">Interop Liveblog: IPv6 Microsegmentation</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 299 May 292929 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/liveblog">Liveblog</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;829 words (estimated 4 minutes to read)</span>
  <p>This session was titled &ldquo;IPv6 Microsegmentation,&rdquo; and the speaker was Ivan Pepelnjak. Ivan is, of course, a well-known figure in the networking space, and publishes content at <a href="http://ipspace.net">http://ipspace.net</a>.</p>
<p>The session starts with a discussion of the problems found in Layer 2 IPv6 networks. Some of the problems include spoofing RA (Router Advertisement) messages, NA (Neighbor Advertisement) messages, DHCPv6 spoofing, DAD (Duplicate Address Detection) DoS attacks, and ND (Neighbor Discovery) DoS attacks. All of these messages derive from the assumption that one subnet = one security zone, and therefore intra-subnet communications are not secured.</p>
<p>Note that some of these attacks are also common to IPv4 and are not necessarily unique to IPv6. The difference is that these problems are well understood in IPv4 and therefore many vendors have implemented solutions to mitigate the risks.</p>
<p>According to Ivan, the root cause of all these problems originates with the fact that all LAN infrastructure today emulates 40 year old thick coax cable.</p>
<p>The traditional fix is to add kludges&hellip;.er, new features&mdash;like RA guard (prevents non-routers from sending RA messages), DHCPv6 guard (same sort of functionality), IPv6 ND inspection (same idea), and SAVI (Source Address Verification Inspection; complex idea where all these various messages are inspected and attempt to verify address ownership). The challenge with some of these fixes is that IPv6&rsquo;s extension headers&mdash;which come before TCP or UDP header&mdash;can sometimes be manipulated to bypass such protections. Further, these features are only vendor- and/or platform-specific, and therefore aren&rsquo;t broadly available to all customers and all implementations. These protections are also expensive to implement in hardware.</p>
<p>The proposed solution suggested by Ivan is to move to Layer 3-only IPv6 network designs. In such a design, the first-hop network device is a layer 3 switch (router). This means there is no RA spoofing, ND spoofing, or NA spoofing. But is this actually possible? Ivan indicates that some networks are already built this way&mdash;an example is T-Mobile&rsquo;s mobile network, which in some cases uses only IPv6. In such cases, every mobile device has its own /64 subnet. This is also true on many xDSL implementations (when PPPoX is in use). Unfortunately, it&rsquo;s much harder to implement on Carrier Ethernet, and almost impossible on cable networks.</p>
<p>For Carrier Ethernet, Cisco ME3600&mdash;a very expensive switch&mdash;will allow you to implement such an architecture. It can also be done using a dedicated VLAN for each customer, which would require extensive service automation (and may create some scale issues?).</p>
<p>Can we use shared Layer 3 IPv6 subnets? If the router sends RA messages without any prefixes, then devices are forced to send their packets to the router&mdash;which can then enforce any necessary security issues. Unfortunately, it doesn&rsquo;t address some of the spoofing attacks, so RA and ND attacks are still possible. Private VLANs (PVLANs) can address that problem, but might break DAD process (a DAD proxy on the router would be needed).</p>
<p>(The ND cache in IPv6 is like the ARP cache in IPv4.)</p>
<p>What about data centers, where workload mobility is a key requirement? VLANs are <em>not</em> the solution, according to Ivan (I don&rsquo;t necessarily disagree). Some potential solutions include a VLAN per VM (not recommended) or PVLANs (complex); both of these solutions prevent aggregation due to workload mobility. These solutions may also cause problems with various vendor-specific IPv6 limitations (example given is only 3K IPv6 routes supported versus 12K IPv4 routes).</p>
<p>Ivan next theorizes about a potential solution in which routers detect adjacent hosts (via DAD or other messages). The first-hop router creates a host route, which are then propagated throughout the local routing domain. IPv6 ND entries are used instead of IPv6 routing table entries. This bypasses some IPv6 limitations because host routes are treated in hardware like ND cache entries (which means you get something like 32K entries).</p>
<p>This sort of approach is used by Hyper-V, which uses L3-only switching for both intra-hypervisor and inter-hypervisor traffic. Some orchestration system pushes entries into the hosts so that all hosts know the addresses of all other hosts. The host then proxies ARP/ND queries, and performs only L3 switching for all traffic.</p>
<p>Cisco&rsquo;s Dynamic Fabric Automation (DFA) also does only L3 switching. Via discovery of host routers via ARP/ND/DHCPv6 messages, all switches know all host routes, all fabric routes, and all external routes. Leaf switches share the same IP address and same MAC address on the &ldquo;downstream&rdquo; interface, so L3 forwarding is always optimal (even in workload mobility situations).</p>
<p>So why bother with all these solutions? First, they remove all IPv6 first-hop security challenges (the solution lies in creating point-to-point links between the host and the first-hop network device). Products that support IPv6 and IPv4 host route-based forwarding include Hyper-V Network Virtualization, Juniper Contrail, and Cisco DFA. IPv4-only implementations include Nuage Virtual Services Platform (VSP) and Cisco Application Centric Infrastructure (ACI). VMware NSX has a stateful IPv6 firewall that provides RA guard and ND inspection services. (Microsoft also has a stateful IPv6 firewall.)</p>
<p>With that, Ivan wraps up the session.</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/networking">Networking</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/interop2015">Interop2015</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/security">Security</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2015/04/24/vsphere-on-aws-gce-ravello/">Running vSphere on AWS or GCE</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2015/04/29/techniques-network-detective/">Interop Liveblog: Techniques of a Network Detective</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2015%2f04%2f29%2fipv6-microsegmentation%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2015%2f04%2f29%2fipv6-microsegmentation%2f&text=Interop%20Liveblog%3a%20IPv6%20Microsegmentation" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2015%2f04%2f29%2fipv6-microsegmentation%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2015/04/24/technology-short-take-50/">Technology Short Take #50</a> <span class="post-date-list">249 May 242424</span></li><li><a href="/2015/03/10/technology-short-take-49/">Technology Short Take #49</a> <span class="post-date-list">109 May 101010</span></li><li><a href="/2015/02/10/technology-short-take-48/">Technology Short Take #48</a> <span class="post-date-list">109 May 101010</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
