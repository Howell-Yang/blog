<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Lessons Learned About Exchange Server 2007 - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="Lessons Learned About Exchange Server 2007 - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="Lessons Learned About Exchange Server 2007 - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2007/10/31/lessons-learned-about-exchange-server-2007/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">Lessons Learned About Exchange Server 2007</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 319 May 313131 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/rant">Rant</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;679 words (estimated 4 minutes to read)</span>
  <p>I&rsquo;m in the midst of a non-virtualization-related project right now, which is a bit odd; a great majority of my work these days is centered around virtualization. Nevertheless, I try to view every project as one from which I can learn. I have definitely learned some things with this project, that&rsquo;s for sure.</p>
<p>Here are a few tidbits that I&rsquo;ve learned so far this week, most of them centered around the installation of Microsoft Exchange Server 2007.</p>
<h2 id="no-gui-setup">No GUI Setup</h2>
<p>First, if you have even <em>one</em> Active Directory domain controller that isn&rsquo;t running Windows Server 2003 SP1, you can&rsquo;t use the GUI setup routine for installing Exchange Server 2007. That&rsquo;s right, no GUI setup for you. Instead, you&rsquo;ll have to install from the command line like this:</p>
<pre><code>setup.com /mode:install /roles:mb, ca, ht, mt /EnableLegacyOutlook /LegacyRoutingServer:oldserver.domain.com /dc:win2k3sp1.domain.com
</code></pre>
<p>Nice, eh? Supposedly this will be fixed in Exchange 2007 SP1.</p>
<h2 id="failures-with-local-cd-roms">Failures with Local CD-ROMs</h2>
<p>Apparently, about 20% of the installations run from the command-line fail with an error about being unable to access the source files. This is even when installing from local CD-ROM, as I was. The Microsoft tech I spoke with recognized that this was a problem; the suggested solution was to copy the files from the CD to a local hard drive and run setup from there.</p>
<h2 id="legacyroutingserver-switch">LegacyRoutingServer Switch</h2>
<p>The use of the &ldquo;/LegacyRoutingServer:&rdquo; command-line switch, which is required for interoperability with &ldquo;legacy&rdquo; Exchange 2000/2003 servers, can only be used when installing the very first server with the Hub Transport role (the &ldquo;ht&rdquo; in the command line above). If the installation of that first server dies for some reason&mdash;say, like due to some strange error about not being able to access the source files, even if they are on a local CD-ROM&mdash;then you won&rsquo;t be able to use this command-line switch again. This means you&rsquo;ll need to create the appropriate connector yourself manually after installation.</p>
<h2 id="cas-installation-failure">CAS Installation Failure</h2>
<p>If Exchange Server 2007 setup fails while installing the Client Access server role (the &ldquo;ca&rdquo; in the setup command line above) citing an error about not being able to find an object (see <a href="http://technet.microsoft.com/en-us/library/bb738162.aspx">this URL</a>), then you&rsquo;ve got some damaged attributes in Active Directory. In my case, while sitting on hold with Microsoft Support for an hour, I resolved it by doing a full dump of the domain and configuration naming contexts of Active Directory using <code>ldifde</code>:</p>
<pre><code>ldifde -f example.domain.ldf -d &quot;dc=example,dc=com&quot;  
ldifde -f example.config.ldf -d &quot;cn=configuration,dc=example,dc=com&quot;
</code></pre>
<p>I was then able to find the specific object with which Exchange Server 2007 Setup was having a problem and fix it. In my case, the Offline Address Book server had somehow gotten damaged and was causing setup to fail. I was able to manually correct the problem using Exchange 2000 System Manager and then Exchange Server 2007 setup proceeded to completion.</p>
<h2 id="smtp-routing-loop-with-smart-host">SMTP Routing Loop with Smart Host</h2>
<p>Specifying a smart host on the SMTP virtual server properties on your &ldquo;legacy&rdquo; Exchange servers will cause a routing loop, and mail won&rsquo;t flow between the new and old servers. Apparently this is documented somewhere, although the Microsoft tech I spoke to could only point me to some articles about how to configure a smart host. I haven&rsquo;t seen any documentation yet that recommends checking and fixing this potential problem. Furthermore, the troubleshooting tools in Exchange Server 2007 pick this up, but fail to tell you that it could be a problem.</p>
<h2 id="aspnet-required">ASP.NET Required</h2>
<p>Oh, yes, I almost forgot about one: ASP.NET is required for Exchange Server 2007, but what happens when you can&rsquo;t install it via Add/Remove Programs &gt; Add/Remove Windows Components? That&rsquo;s right, back to the command line again:</p>
<pre><code>%systemroot%\Microsoft.NET\Framework64\v2.0.50727\aspnet_regiis.exe -ir -enable
</code></pre>
<p>This is assuming, of course, that you&rsquo;ve already installed the .NET Framework 2.0 on your server in preparation for Exchange.</p>
<p>You are welcome to tell me that I&rsquo;m an idiot for not knowing this stuff, on one condition: you provide a URL where information about the problem is posted and a workaround provided. That way, when someone else runs into the issue, we&rsquo;ll at least know where to point them for help.</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/activedirectory">ActiveDirectory</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/exchange">Exchange</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/microsoft">Microsoft</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/windows">Windows</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2007/10/31/virtual-mac-os-x/">Virtual Mac OS X</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2007/11/01/lm-and-ntlm-authentication-in-ad-integration/">LM and NTLM Authentication in AD Integration</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2007%2f10%2f31%2flessons-learned-about-exchange-server-2007%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2007%2f10%2f31%2flessons-learned-about-exchange-server-2007%2f&text=Lessons%20Learned%20About%20Exchange%20Server%202007" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2007%2f10%2f31%2flessons-learned-about-exchange-server-2007%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2005/09/26/error-id-c10308a2-is-put-to-rest/">Error ID c10308a2 is Put to Rest</a> <span class="post-date-list">269 May 262626</span></li><li><a href="/2005/09/22/have-you-seen-error-id-c10308a2/">Have You Seen Error ID c10308a2?</a> <span class="post-date-list">229 May 222222</span></li><li><a href="/2007/07/09/uac-and-ktpassexe/">UAC and ktpass.exe</a> <span class="post-date-list">99 May 9099</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
