<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Resizing Disks Inside Guests - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="Resizing Disks Inside Guests - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="Resizing Disks Inside Guests - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2007/05/15/resizing-disks-inside-guests/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">Resizing Disks Inside Guests</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 159 May 151515 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/explanation">Explanation</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;598 words (estimated 3 minutes to read)</span>
  <p>While I would love to be able to say that this procedure I&rsquo;m going to describe for resizing disks inside guest VMs is new or unique or original, I can&rsquo;t. I&rsquo;m sure that lots of smart people out there have been down this path before, and more than a couple of them have probably written up good instructions on how to do it. I&rsquo;m including this information here partly for myself (in the event I need it in the future), and partly because the information fits in with a lot of the other information I have here on <a href="http://www.vmware.com/">VMware</a> and related technologies.</p>
<p>So, with that being said, here&rsquo;s how I recently went about resizing some guest VM disks using <code>vmkfstools</code> and <a href="http://gparted.sourceforge.net/index.php">GParted</a> (specifically, the <a href="http://gparted.sourceforge.net/livecd.php">GParted LiveCD</a>). This process assumes you need to resize a Windows guest. The process should be very similar if not the same for non-Windows guests, but I haven&rsquo;t tested it so I can&rsquo;t be absolutely certain. The process is very straightforward and not unusual in the least, but feel free to post any corrections or questions in the comments.</p>
<ol>
<li>
<p>Download the GParted LiveCD (here&rsquo;s a <a href="http://sourceforge.net/project/showfiles.php?group_id=115843&amp;package_id=173828">direct link</a>) and then upload it to your <a href="http://www.vmware.com/products/vi/esx/">ESX Server</a> using the file upload tool of your choice. Being a <a href="http://www.apple.com/macosx/">Mac OS X</a> user, I use <a href="http://www.nolobe.com/interarchy/">Interarchy</a>. Use whatever best suits you.</p>
</li>
<li>
<p>Power off the VM that you will be manipulating. (I know, that seems obvious, but still&hellip;)</p>
</li>
<li>
<p>Open an SSH session to the ESX Server where your guest VM is hosted. Switch to root, change into the appropriate directory where the VM is stored, and then run the command <code>vmkfstools -X &lt;New disk size&gt; &lt;VMDK filename&gt;</code>. For example, if your current virtual hard disk was 10GB and you wanted to make it 20GB, then specify &ldquo;20g&rdquo; on the command line, i.e., specify the new total size of the disk, <em>not</em> the amount by which to increase it.</p>
</li>
<li>
<p>Flipping to the graphical VI Client, change the CD-ROM of the guest VM to be the ISO image of the GParted LiveCD you downloaded earlier. Make sure it is set to connect at power on. Power on the VM and boot from the CD.</p>
</li>
</ol>
<p>Note that booting from the CD can be a bit tricky. You may need to boot up several times before you catch it just right. <em>Be sure</em> that if Windows starts booting up, you let it boot up and then shut it back down again. If you reset the VM in the midst of the Windows boot sequence, the NTFS filesystem will be marked as &ldquo;dirty&rdquo; and GParted won&rsquo;t make the changes you wanted.</p>
<ol start="5">
<li>
<p>GParted will boot up from the CD. You may need to press Enter a couple of times to accept the defaults (unless you need settings other than the defaults, of course) before the graphical environment loads and you see the GParted interface. Once the GParted interface is up, you should be able to figure out how to make the changes you want to make.</p>
</li>
<li>
<p>Shutdown the VM (you can use the shutdown option in GParted), disconnect the CD-ROM, and power the VM back up again. When Windows boots, it will run a Chkdsk, then reboot again, and then come up to a login screen. After you login, you may be prompted to reboot again after the discovery of &ldquo;new hardware.&rdquo; After that final reboot, you should be good to go with a new, larger virtual hard disk.</p>
</li>
</ol>
<p>The most time consuming portion, in my experience, is waiting for GParted to boot from the ISO image. Otherwise, the entire process is almost completely painless.</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/hardware">Hardware</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/linux">Linux</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/virtualization">Virtualization</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/vmware">VMware</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2007/05/15/netapp-flexclones-with-vmware-part-1/">NetApp FlexClones with VMware, Part 1</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2007/05/17/netapp-flexclones-with-vmware-part-2/">NetApp FlexClones with VMware, Part 2</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2007%2f05%2f15%2fresizing-disks-inside-guests%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2007%2f05%2f15%2fresizing-disks-inside-guests%2f&text=Resizing%20Disks%20Inside%20Guests" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2007%2f05%2f15%2fresizing-disks-inside-guests%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2006/06/27/netapp-ontap-simulator-and-esx-server/">NetApp ONTAP Simulator and ESX Server</a> <span class="post-date-list">279 May 272727</span></li><li><a href="/2007/04/12/vmware-as-middleware/">VMware as Middleware</a> <span class="post-date-list">129 May 121212</span></li><li><a href="/2007/03/27/new-vmotion-boundary/">New VMotion Boundary</a> <span class="post-date-list">279 May 272727</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
