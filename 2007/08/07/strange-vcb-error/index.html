<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Strange VCB Error - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="Strange VCB Error - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="Strange VCB Error - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2007/08/07/strange-vcb-error/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">Strange VCB Error</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 79 May 7077 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/explanation">Explanation</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;695 words (estimated 4 minutes to read)</span>
  <p>While in the process of verifying the operation of <a href="http://www.vmware.com/products/vi/consolidated_backup.html">VMware Consolidated Backup</a> (version 1.0.3) today using the command-line <code>vcbMounter.exe</code> utility, I kept receiving an error from vcbMounter and the full VM backups would fail. Nothing seemed obvious at first, so I added the &ldquo;-L 6&rdquo; parameter to the command line, which was something like this:</p>
<pre><code>vcbmounter -h vcserver.example.com -u username -p password  
-r e:\mnt -a ipaddr:10.1.1.107 -t fullvm -L 6
</code></pre>
<p>Nothing terribly complicated there, just a simple full VM backup of the VM whose IP address is 10.1.1.107. (For those of you that aren&rsquo;t familiar with the <code>vcbMounter.exe</code> command-line syntax, it looks worse than it actually is. Trust me.) Upon running this command with the increased logging, I kept getting these errors:</p>
<pre><code>[2007-08-07 12:13:47.418 'App' 2144 warning] Could not
obtain inquiry page 128 for device on path 0, target 4, lun 0  

[2007-08-07 12:13:47.418 'App' 2144 warning] Sending SCSI inquiry 
failed: Unknown error. (No proper error code was returned.)  

[2007-08-07 12:13:47.418 'App' 2144 warning] Could not 
obtain inquiry page 128 for device on path 0, target 5, lun 0  

[2007-08-07 12:13:47.418 'App' 2144 warning] Sending SCSI inquiry
failed: Unknown error. (No proper error code was returned.)`
</code></pre>
<p>The odd thing was, target ID 4 and target ID 5 were <em>local SCSI targets</em>, not anything SAN-related. In fact, they were the system (C:) and data (D:) drives that had been created when the server was built and <a href="http://www.microsoft.com/windowsserver/default.mspx">Windows Server 2003</a> was installed.</p>
<p>Google turned up nothing obvious, so I decided to try running the command directly against an ESX server. The modified command now looked like this:</p>
<pre><code>vcbmounter -h esxserver.example.com -u root -p password  
-r e:\mnt -a ipaddr:10.1.1.107 -t fullvm -L 6`
</code></pre>
<p>The operation still failed, but now I had a critical piece of missing information:</p>
<pre><code>[2007-08-07 12:29:43.798 'BlockList' 2052 error] Your VirtualCenter or the ESX server hosting the virtual machine you are dealing with needs to be upgraded to work with this version of VCB. (VCB attempted to invoke the method &quot;acquireLeaseExt&quot; on a remote object of type &quot;vim.host.DiskManager&quot;, but this method is unknown to this object type.)
</code></pre>
<p>Aha! A quick review of the environment showed that the ESX host this particular VM was hosted on was indeed running version 3.0.1. With a quick VMotion to a nearby host running ESX Server 3.0.2 and a repeat of the command (changed to target the new host, obviously), and the backup operation worked. I moved the guest back to the original host again, and the operation failed again. This pattern held true regardless of whether the <code>vcbMounter.exe</code> command targeted the VirtualCenter server (which was running version 2.0.2) or the ESX Server.  Anytime the VM was hosted on the ESX server running 3.0.1, the command failed.</p>
<p>&lt;aside&gt;Now why didn&rsquo;t the error message just say that the first time, instead of complaining about local SCSI disks?&lt;/aside&gt;</p>
<p>A quick review of the <a href="http://www.vmware.com/support/vi3/doc/releasenotes_vcb103.html">VCB 1.0.3 release notes</a> turns up this fairly brief blurb:</p>
<blockquote>
<p>VMware Consolidated Backup (VCB) 1.0.3 is compatible with VirtualCenter 2.0.2 and ESX Server 3.0.2 (or newer) only. This release is not supported if used with older version of ESX Server and VirtualCenter.</p>
</blockquote>
<p>OK, fair enough&mdash;I should have more closely read the release notes before getting too deep into the testing. But what this means is that customers won&rsquo;t be able to start using VCB 1.0.3 until all their hosts have been upgraded to ESX Server 3.0.2 and VirtualCenter has been upgraded to 2.0.2. I don&rsquo;t know at this time if VCB 1.0.2 will work against both the newer and older versions; if not, that will put organizations in a situations where they may end up with two different sets of VCB proxy servers: one set to support the hosts running ESX Server 3.0.1, and another set to support hosts running ESX Server 3.0.2. And that doesn&rsquo;t even take VirtualCenter into consideration!</p>
<p>Anyone out there testing VCB 1.0.2 against the newer releases of ESX and VC? This will help tell us if we can leverage the existing VCB infrastructure until after all the hosts have been upgraded, and then upgrade VCB, or if a parallel VCB infrastructure will have to be established to support the newer of ESX and VC.</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/backup">Backup</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/esx">ESX</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/san">SAN</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/virtualization">Virtualization</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/vmware">VMware</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2007/08/07/a-few-more-quick-thoughts-on-fusion/">A Few More Quick Thoughts on Fusion</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2007/08/09/next-generation-virtual-infrastructure/">Next-Generation Virtual Infrastructure</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2007%2f08%2f07%2fstrange-vcb-error%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2007%2f08%2f07%2fstrange-vcb-error%2f&text=Strange%20VCB%20Error" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2007%2f08%2f07%2fstrange-vcb-error%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2007/03/18/various-vmware-links/">Various VMware Links</a> <span class="post-date-list">189 May 181818</span></li><li><a href="/2007/03/06/restoring-vcb-full-backups-with-vmware-converter/">Restoring VCB Full Backups with VMware Converter</a> <span class="post-date-list">69 May 6066</span></li><li><a href="/2006/12/30/recovering-data-inside-vms-using-netapp-snapshots/">Recovering Data Inside VMs Using NetApp Snapshots</a> <span class="post-date-list">309 May 303030</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
