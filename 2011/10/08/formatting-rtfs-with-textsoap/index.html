<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Formatting RTFs with TextSoap - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="Formatting RTFs with TextSoap - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="Formatting RTFs with TextSoap - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2011/10/08/formatting-rtfs-with-textsoap/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">Formatting RTFs with TextSoap</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 89 May 8088 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/explanation">Explanation</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;520 words (estimated 3 minutes to read)</span>
  <p>If there&rsquo;s one thing I miss about trying to avoid Microsoft Word and stick with more &ldquo;open&rdquo; file formats, it&rsquo;s styles. Yes, styles. See, I&rsquo;m a long-time Microsoft Word user, and in a previous life I worked in a role where it was my job to provide consistent formatting for some very large documents (300, 500, or more than 700 pages sometimes). In situations like that, styles are an absolute <strong>must</strong>. So, driven by necessity, I learned about styles, how to use them, and eventually grew to rely very heavily on them.</p>
<p>Now that I&rsquo;m trying eschew Microsoft Word for more lightweight applications and text-based file formats, I&rsquo;m finding that I really miss styles. So, I set out to try and find a way to provide some of the consistent formatting I had with styles, but in a way that is in alignment with my goals. I built a solution using these tools:</p>
<ul>
<li>
<p><a href="http://www.macromates.com/">TextMate</a>, for creating <a href="http://fletcherpenney.net/multimarkdown/">MultiMarkdown</a> source files</p>
</li>
<li>
<p><a href="http://johnmacfarlane.net/pandoc/">Pandoc</a>, for converting the MultiMarkdown sources into RTF</p>
</li>
<li>
<p><a href="http://www.unmarked.com/">TextSoap</a>, for applying some regex-based formatting to the RTF destination file.</p>
</li>
</ul>
<p>It&rsquo;s not the greatest solution in the world, but it does work (so far). Here&rsquo;s the basic flow of the solution:</p>
<ol>
<li>
<p>I create the source file in MultiMarkdown syntax using TextMate. Along the way, I add some user-defined markup in the document for formatting later. Specifically, I&rsquo;ve placed &ldquo;[h1]&rdquo; at the start of level 1 headings, &ldquo;[h2]&rdquo; at the start of level 2 headings, etc. It&rsquo;s almost like another layer of markup within the MultiMarkdown syntax. (Yes, I know this kind of goes against the spirit of Markdown.)</p>
</li>
<li>
<p>I use pandoc to convert the Markdown source document into RTF (a process I&rsquo;ve automated using AppleScript and <a href="http://www.red-sweater.com/fastscripts/">FastScripts</a>). This creates a pretty plain and simple RTF document with my user-defined tags still present. Pandoc supports the idea of templates, but I&rsquo;m not familiar enough with the syntax of RTF to create an RTF template.</p>
</li>
<li>
<p>TextSoap parses the document and uses the user-defined tags to modify the font family and font size accordingly. I use a regular expression (regex) to find lines with the user-defined tag at the beginning, and apply a certain format to that line. After the formatting has been applied, the user-defined tags are removed. After the file has been processed by TextSoap&mdash;which is a really handy tool, by the way; I recommend it for anyone who works with text a lot&mdash;then the document has the formatting that I want and I can proceed with generating a PDF or delivering the RTF file as is.</p>
</li>
</ol>
<p>This process is by no means perfect, but it does allow me to generate all my content using Markdown in TextMate, then spin it off to RTF for quick and easy formatting using TextSoap. This splits the content creation and content formatting steps into separate steps, and allows me to focus on &ldquo;content first, appearance later.&rdquo;</p>
<p>The next evolution in the process will be to use AppleScript to tie the Markdown-to-RTF conversion and the formatting together in a single step (yet another reason to choose TextSoap: it supports and can be driven by AppleScript for automation).</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/collaboration">Collaboration</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/macos">macOS</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/writing">Writing</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2011/10/06/mastering-vmware-vsphere-5-now-available/">Mastering VMware vSphere 5 Now Available</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2011/10/25/my-experiences-with-lion/">My Experiences with Lion</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2011%2f10%2f08%2fformatting-rtfs-with-textsoap%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2011%2f10%2f08%2fformatting-rtfs-with-textsoap%2f&text=Formatting%20RTFs%20with%20TextSoap" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2011%2f10%2f08%2fformatting-rtfs-with-textsoap%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2011/10/05/content-creation-and-mind-mapping/">Content Creation and Mind Mapping</a> <span class="post-date-list">59 May 5055</span></li><li><a href="/2011/05/03/applescripts-for-yojimbo-camino-and-skim/">AppleScripts for Yojimbo, Camino, and Skim</a> <span class="post-date-list">39 May 3033</span></li><li><a href="/2009/12/09/vmware-vsphere-4-administration-instant-reference-now-available/">VMware vSphere 4 Administration Instant Reference Now Available</a> <span class="post-date-list">99 May 9099</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
