<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>OTV and VXLAN Layer 3 Connectivity Compared - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="OTV and VXLAN Layer 3 Connectivity Compared - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="OTV and VXLAN Layer 3 Connectivity Compared - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2011/12/22/otv-and-vxlan-layer-3-connectivity-compared/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">OTV and VXLAN Layer 3 Connectivity Compared</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 229 May 222222 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/explanation">Explanation</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;784 words (estimated 4 minutes to read)</span>
  <p>Building large-scale L2 networks, including stretched L2 networks, seems to be all the rage these days, driven in part by virtual machine mobility (aka vMotion in VMware vSphere environments or XenMotion in Citrix XenServer environments). While this isn&rsquo;t always a good idea&mdash;some might say it&rsquo;s <a href="http://blog.ioshints.info/2011/12/large-scale-l2-dci-true-story.html">never a good idea</a>&ndash;it is still something that many organizations are evaluating.</p>
<p>With the announcement of VXLAN at VMworld 2011, a new question seems to have arisen: can I use VXLAN instead of (insert some other protocol here) to create my stretched L2 networks? In this post, I&rsquo;d like to compare the use of VXLAN with OTV (Overlay Transport Virtualization) for that very purpose. Of course, since VXLAN hasn&rsquo;t actually been released, the discussion is partially theoretical.</p>
<p>My primary focus in this post will be how each of these protocols handles traffic patterns in the course of addressing the need for L2 connectivity over routed L3 networks.</p>
<p>First, let&rsquo;s look at VXLAN. The figure below is taken from my <a href="/2011/12/07/revisiting-vxlan-and-layer-3-connectivity/">revised L3 connectivity with VXLAN post</a>, which I encourage you to read for more details.</p>
<p><img src="/public/img/fixed-l3-postmig.png" alt=""></p>
<p>As you can see, once a VM inside a VXLAN segment is migrated to a new network, the traffic &ldquo;trombones&rdquo; back and forth across the VXLAN segment because all traffic has to pass through a single vShield Edge (VSE) instance. This brings up a key limitation of VXLAN that I think is important to point out: VXLAN has an innate dependency on VSE, and <strong>VSE cannot be made redundant.</strong> That&rsquo;s right&mdash;you can&rsquo;t have VSE-specific failover functionality; instead, you have to rely on vSphere HA, VM Monitoring, and other features. That means failover times in the minutes, not seconds. What do you think that will do to network connections?</p>
<p>Now, let&rsquo;s compare VXLAN&rsquo;s L3 connectivity with OTV. First, here&rsquo;s a diagram to show connectivity with OTV before a VM is migrated to the second site:</p>
<p><img src="/public/img/otv-l3-premig.png" alt=""></p>
<p>No real surprises here. I&rsquo;ll just point out here that a typical OTV deployment following &ldquo;recommended practices&rdquo; will use redundant Nexus 7000 switches, as shown here. That&rsquo;s a key advantage that OTV has over VXLAN&mdash;the ability to provide redundancy is there and redundancy is easily built into the solution, with failover times in the seconds (or better).</p>
<p>Now, take a look at the post-migration traffic flows with OTV:</p>
<p><img src="/public/img/otv-l3-postmig.png" alt=""></p>
<p>In case you didn&rsquo;t notice it, let me point out the obvious: <strong>note the lack of traffic tromboning here.</strong> Here&rsquo;s how it&rsquo;s accomplished (and documented in <a href="http://ccie5851.blogspot.com/2011/03/otv-deep-dive-part-3.html">this blog post</a> by Ron Fuller, aka <a href="http://twitter.com/ccie5851">@ccie5851</a> or VDCBadger to his friends):</p>
<ul>
<li>
<p>Each Nexus 7000 pair runs HSRP.</p>
</li>
<li>
<p>The HSRP hello packets are filtered (blocked) from the OTV interfaces. This keeps the HSRP pairs in each data center from knowing about the pair in the other data center.</p>
</li>
<li>
<p>Each HSRP pair runs the same virtual IP (the default gateway for the 10.1.1.0/24 subnet).</p>
</li>
</ul>
<p>In this configuration, once the VM migrates to the second site the HSRP pair at the second site won&rsquo;t need to send traffic across the OTV link to reach the migrated VM. This appears to be a significant advantage to OTV&mdash;a greater knowledge of the routing topology allows OTV to be more intelligent about how traffic should be directed across/around the network.</p>
<p>&lt;aside&gt;Of course, this doesn&rsquo;t address L3 routing concerns from subnets not directly attached to the Nexus 7000 pairs. For that, we&rsquo;d need something like LISP.&lt;/aside&gt;</p>
<p>As I see it&mdash;and networking experts are welcome to jump in if I&rsquo;m mistaken&mdash;this gives OTV two key advantages over VXLAN:</p>
<ol>
<li>
<p>OTV, because it is running on physical networking equipment, is more intelligent than VXLAN about how traffic is directed/routed in/around/across a network. This can result in more efficient utilization of a data center interconnect as a result of reduced &ldquo;traffic tromboning.&rdquo;</p>
</li>
<li>
<p>OTV, because it is running on physical networking equipment, can provide better redundancy and faster failover than VXLAN (which relies on single instances of VSE).</p>
</li>
</ol>
<p>It&rsquo;s entirely possible that if VXLAN ever makes it into physical network equipment that these advantages of OTV will be nullified.</p>
<p>It&rsquo;s also important to point out that while OTV and VXLAN have some overlap in functionality they are partially targeted at solving different problems. While both protocols address L2 connectivity across L3 networks, VXLAN also addresses the exhaustion of the VLAN address space in larger networks (especially service provider networks). This is an issue that OTV does not try to address. However, it seems to me that OTV would co-exist better with a solution like Q-in-Q, which could (as far as I can tell) address the VLAN ID exhaustion issue.</p>
<p>Once again, I encourage network experts to chime in and share their views. If I&rsquo;ve misstated something, please let me know. Questions, thoughts, and comments are always welcome.</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/networking">Networking</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/otv">OTV</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/virtualization">Virtualization</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/vxlan">VXLAN</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2011/12/16/vmware-view-client-for-mac-with-pcoip/">VMware View Client for Mac with PCoIP</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2012/01/02/some-projects-for-2012/">Some Projects for 2012</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2011%2f12%2f22%2fotv-and-vxlan-layer-3-connectivity-compared%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2011%2f12%2f22%2fotv-and-vxlan-layer-3-connectivity-compared%2f&text=OTV%20and%20VXLAN%20Layer%203%20Connectivity%20Compared" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2011%2f12%2f22%2fotv-and-vxlan-layer-3-connectivity-compared%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2011/12/07/revisiting-vxlan-and-layer-3-connectivity/">Revisiting VXLAN and Layer 3 Connectivity</a> <span class="post-date-list">79 May 7077</span></li><li><a href="/2011/11/30/vxlan-and-layer-3-connectivity/">VXLAN and Layer 3 Connectivity</a> <span class="post-date-list">309 May 303030</span></li><li><a href="/2011/10/03/technology-short-take-15/">Technology Short Take #15</a> <span class="post-date-list">39 May 3033</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
