<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Thinking Out Loud: What if vSphere Supported FabricPath? - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</title>

  
  <meta name="author" content="Howell Yang">
  <meta property="og:site_name" content="Scott&#39;s Weblog">
  
  <meta property="og:description" content="Thinking Out Loud: What if vSphere Supported FabricPath? - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  <meta property="og:title" content="Thinking Out Loud: What if vSphere Supported FabricPath? - Howell Yang&#39;s Weblog - 我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。">
  
  <meta property="og:type" content="article">
  <meta name="keywords" content="Cloud, Containers, Kubernetes, K8s, Docker, CNI, CRI-O, OCI, Linux, CLI, Networking, AWS, Security, DevOps">

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/font-awesome/css/font-awesome.min.css">

  
  <link rel="canonical" href="https://www.howellyang.com/2011/08/08/thinking-out-loud-what-if-vsphere-supported-fabricpath/">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  </head>
<body class="theme-base-0d">
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><img src="/public/img/orbits-thumb.gif" alt="Orbits" width="128" height="128" /></p>
    <p>Original, technical content centered around cloud computing, Kubernetes, Linux, and networking</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">Home</a>
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Site Archives</a>
    <a class="sidebar-nav-item" href="/categories/">Post Categories</a>
    <a class="sidebar-nav-item" href="/tags/">Content Tags</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://github.com/howellyang"><i class="fa fa-github fa-3x"></i></a>
      <a href="https://twitter.com/None"><i class="fa fa-twitter fa-3x"></i></a>
      <a href="https://www.linkedin.com/in/None"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="http://feeds.scottlowe.org/slowe/content/feed/"><i class="fa fa-rss fa-3x"></i></a>
    </p>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2005-2022. All rights reserved.</p>
  </div>
</div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Howell Yang&#39;s Weblog</a>
            <small>我是杨豪，专注于深度学习模型的训练、剪枝、量化、部署以及工程效率优化。欢迎来到我的博客。</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="post">
  <h1 class="post-title">Thinking Out Loud: What if vSphere Supported FabricPath?</h1>
  <span class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>&#160;Published on 89 May 8088 &middot;
    <i class="fa fa-folder-open-o" aria-hidden="true"></i>&#160;Filed in <a href="/categories/musing">Musing</a> &middot;
    <i class="fa fa-pencil" aria-hidden="true"></i>&#160;793 words (estimated 4 minutes to read)</span>
  <p>Since attending Cisco Live 2011 in Las Vegas earlier this year (see my <a href="/2011/07/15/summary-of-cisco-live-2011-blog-posts/">summary list of blog posts</a>), my mind has been swirling with ideas about how various technologies might work (or not work) together. In the first of a series of &ldquo;Thinking Out Loud&rdquo; posts in which I&rsquo;ll attempt to explore&mdash;and spur discussion regarding&mdash;how certain networking technologies might integrate with virtualization technologies, I&rsquo;d like to explore this question: &ldquo;What if vSphere had FabricPath support?&rdquo;</p>
<p>&lt;aside&gt;By the way, if you&rsquo;re not familiar with the &ldquo;Thinking Out Loud&rdquo; posts, the key point is simply to stimulate discussion and encourage knowledge sharing.&lt;/aside&gt;</p>
<p>If you&rsquo;re unfamiliar with FabricPath, you might find my <a href="/2011/07/12/brkdct-2081-cisco-fabricpath-technology-and-design/">session blog of a FabricPath session</a> at Cisco Live helpful to bring you up to speed. Also, while this post focuses on potential FabricPath integration, I think many of the same points would apply to TRILL and potentially SPB.</p>
<p>When I first started considering this idea, a few things came to mind:</p>
<ol>
<li>
<p>The first thing that came to mind was that the quickest, most &ldquo;natural&rdquo; way of bringing FabricPath support to vSphere would be via the Nexus 1000V. While I&rsquo;m sure that the NX-OS code base between the Nexus 1000V and the Nexus 7000 (where FabricPath is available) is dramatically different, it&rsquo;s still closer than trying to add FabricPath support directly to vSphere.</p>
</li>
<li>
<p>The second thought was that, intuitively, FabricPath would bring value to vSphere. After all, FabricPath is about eliminating STP and increasing the effective bandwidth of your network, right?</p>
</li>
</ol>
<p>It&rsquo;s this second thought I&rsquo;d like to drill down on in this post.</p>
<p>When I first started considering what benefits, if any, FabricPath support in vSphere might bring, I thought that FabricPath would really bring some value. After all, what does FabricPath bring to the datacenter network? Multiple L2 uplinks between switches, low latency any-to-any switching, and equal cost multipathing, to name a few things. Surely these would be of great benefit to vSphere, wouldn&rsquo;t they? That&rsquo;s what I thought&hellip;until I created a diagram.</p>
<p>Consider this diagram of a &ldquo;regular&rdquo; vSphere network topology:</p>
<p><img src="/public/img/non-fp-aware-network.png" alt="Non-FP-aware network"></p>
<p>This is fairly straightforward stuff, found in many data centers today. What would bringing FabricPath into this network, all the way down to the ESXi hosts, give us? Consider this diagram:</p>
<p><img src="/public/img/fp-aware-network-01.png" alt="FP-aware network 1"></p>
<p>We&rsquo;ve replaced the upstream switches with FabricPath-aware switches and put in our fictional FP-aware Nexus 1000V, but what does it change? From what I can tell, not much changes. Consider these points:</p>
<ul>
<li>
<p>In both cases, each Nexus 1000V has two uplinks and has the ability to actively use both uplinks. The only difference the presence of FabricPath would make, as far as I can tell, is in the selection of which uplink to use.</p>
</li>
<li>
<p>In both cases, host-to-host (or VM-to-VM) traffic still has to travel through the upstream switches. The presence of FabricPath awareness on the vSphere hosts doesn&rsquo;t change this.</p>
</li>
</ul>
<p>That second point, in my mind, deserves some additional thought. FabricPath enables multiple, active L2 links between switches, but in both of the topologies shown above the traffic has to travel through the upstream switches. In fact, the only way to change the travel patterns would be to add extra host-to-host links, like this:</p>
<p><img src="/public/img/fp-aware-network-02.png" alt="FP-aware network 2"></p>
<p>OK, if these extra host-to-host links were present, then the presence of FabricPath at the ESXi host layer might make a difference. VM-to-VM traffic could then just hop across without going through the upstream switches. All is good, right?</p>
<p>Not so fast! I&rsquo;m not a networking guru, but I see some potential problems with this:</p>
<ul>
<li>
<p>This approach isn&rsquo;t scalable. You&rsquo;d have to have host-to-host links between every ESXi host, which means for <em>N</em> hosts you&rsquo;ll need <em>(N-1)</em> uplinks. That would limit the scalability of &ldquo;fabric-connected&rdquo; vSphere hosts since there just isn&rsquo;t enough room to add that many networking ports (nor it is very cost effective).</p>
</li>
<li>
<p>Does adding host-to-host links fundamentally change the nature of the virtual switch? The way virtual switches (or edge virtual bridges, if you prefer) operate today is predicated upon certain assumptions; would these assumptions need to change? I&rsquo;m not sure about this point yet; I&rsquo;m still processing the possibilities.</p>
</li>
<li>
<p>What does this topology <em>really</em> buy an organization? Most data center switches have pretty low L2 switching latencies (and getting lower all the time). Would a host-to-host link really get us any better performance? I somehow don&rsquo;t think so.</p>
</li>
</ul>
<p>In the end, it seems to me that there is (currently) very little value in bringing FabricPath (or TRILL or SPB) support all the way down to the virtualization hosts. However, I&rsquo;d love to hear what you think. Am I wrong in some of my conclusions? My understanding of FabricPath (and related technologies) is still evolving, so please let me know if something I&rsquo;ve said is incorrect. Speak up in the comments!</p>


  <h3>Metadata and Navigation</h3>
  <span class="post-meta">
  <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/cisco">Cisco</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/networking">Networking</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/virtualization">Virtualization</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/vmware">VMware</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/vsphere">vSphere</a> <i class="fa fa-tag" aria-hidden="true"></i>&#160;<a href="/tags/tol">ToL</a> 

  <br />
  <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous Post: <a href="https://www.howellyang.com/2011/07/26/vmworld-2011-spousetivities/">VMworld 2011 Spousetivities</a>
  
  <br />
   <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Next Post: <a href="https://www.howellyang.com/2011/08/12/a-deeper-look-at-vasa/">A Deeper Look at VASA</a>
  </span>

  <span class="post-sharing">
  <p>Be social and share this post!<br />

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.howellyang.com%2f2011%2f08%2f08%2fthinking-out-loud-what-if-vsphere-supported-fabricpath%2f" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
  <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.howellyang.com%2f2011%2f08%2f08%2fthinking-out-loud-what-if-vsphere-supported-fabricpath%2f&text=Thinking%20Out%20Loud%3a%20What%20if%20vSphere%20Supported%20FabricPath%3f" title="Share on Twitter"><i class="fa fa-twitter-square fa-2x"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.howellyang.com%2f2011%2f08%2f08%2fthinking-out-loud-what-if-vsphere-supported-fabricpath%2f" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a></p>
  </span>
</div>

<div class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
  <li><a href="/2011/02/17/technology-short-take-11/">Technology Short Take #11</a> <span class="post-date-list">179 May 171717</span></li><li><a href="/2011/01/27/technology-short-take-10/">Technology Short Take #10</a> <span class="post-date-list">279 May 272727</span></li><li><a href="/2010/12/29/technology-short-take-9/">Technology Short Take #9</a> <span class="post-date-list">299 May 292929</span></li>
  </ul>
</div>      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>
